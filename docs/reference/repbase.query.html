<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Query the RepBase to annotate putative LTRs — repbase.query • LTRpred</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Query the RepBase to annotate putative LTRs — repbase.query" />
<meta property="og:description" content="Validate or annotate putative LTR
transposons that have been predicted using LTRharvest or LTRdigest." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTRpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction.html">Introduction to LTRpred</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HajkD/LTRpred/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Query the RepBase to annotate putative LTRs</h1>
    <small class="dont-index">Source: <a href='https://github.com/HajkD/LTRpred/blob/master/R/repbase.query.R'><code>R/repbase.query.R</code></a></small>
    <div class="hidden name"><code>repbase.query.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Validate or annotate putative LTR
transposons that have been predicted using LTRharvest or LTRdigest.</p>
    </div>

    <pre class="usage"><span class='fu'>repbase.query</span><span class='op'>(</span>
  <span class='va'>seq.file</span>,
  <span class='va'>repbase.path</span>,
  output <span class='op'>=</span> <span class='st'>"RepbaseOutput.txt"</span>,
  max.hits <span class='op'>=</span> <span class='fl'>5000</span>,
  eval <span class='op'>=</span> <span class='fl'>1e-30</span>,
  cores <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>seq.file</th>
      <td><p>file path to the putative LTR transposon sequences in <code>fasta</code> format.</p></td>
    </tr>
    <tr>
      <th>repbase.path</th>
      <td><p>file path to the RepBase file in <code>fasta</code> format.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>file name of the BLAST output.</p></td>
    </tr>
    <tr>
      <th>max.hits</th>
      <td><p>maximum number of hits that shall be retrieved that still fulfill the e-value criterium.
Default is <code>max.hits = 5000</code>.</p></td>
    </tr>
    <tr>
      <th>eval</th>
      <td><p>e-value threshold for BLAST hit detection. Default is <code>eval = 1E-30</code>.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>number of cores to use to perform parallel computations.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The RepBase database provides a collection of curated transposable element annotations.</p>
<p>This function allows users to validate or annotate putative LTR
transposons that have been predicted using LTRharvest or LTRdigest by blasting predicted LTR transposons 
to transposons known (annotated) in other species (e.g. such as Arabidopsis thaliana).</p>
<p>Internally, this function performs a <code>blastn</code> search of the putative LTR transposons predicted
by LTRharvest or LTRdigest against the Repbase fasta file that is specified by the user.</p>
<p>For this purpose it is required that the user has a working version of BLAST+ running on his or her machine.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>http://www.girinst.org/repbase/</p>
<p>Altschul, S.F., Gish, W., Miller, W., Myers, E.W. &amp; Lipman, D.J. (1990) "Basic local alignment search tool." J. Mol. Biol. 215:403-410.</p>
<p>Gish, W. &amp; States, D.J. (1993) "Identification of protein coding regions by database similarity search." Nature Genet. 3:266-272.</p>
<p>Madden, T.L., Tatusov, R.L. &amp; Zhang, J. (1996) "Applications of network BLAST server" Meth. Enzymol. 266:131-141.</p>
<p>Altschul, S.F., Madden, T.L., Schaeffer, A.A., Zhang, J., Zhang, Z., Miller, W. &amp; Lipman, D.J. (1997) "Gapped BLAST and PSI-BLAST: a new generation of protein database search programs." Nucleic Acids Res. 25:3389-3402.</p>
<p>Zhang Z., Schwartz S., Wagner L., &amp; Miller W. (2000), "A greedy algorithm for aligning DNA sequences" J Comput Biol 2000; 7(1-2):203-14.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Hajk-Georg Drost</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='co'># Example annotation run against the A thaliana RepBase using 4 cores</span></span>
<span class='r-in'><span class='va'>q</span> <span class='op'>&lt;-</span> <span class='fu'>repbase.query</span><span class='op'>(</span>seq.file     <span class='op'>=</span> <span class='st'>"path/to/LTRtransposonSeqs.fasta"</span>,</span>
<span class='r-in'>                  repbase.path <span class='op'>=</span> <span class='st'>"path/to/Athaliana_repbase.ref"</span>,</span>
<span class='r-in'>                  cores        <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span>
<span class='r-in'>                 </span>
<span class='r-in'><span class='va'>Annot</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/select.html'>select</a></span><span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>q</span>,<span class='va'>query_id</span><span class='op'>)</span>, </span>
<span class='r-in'>                                    <span class='op'>(</span><span class='va'>bit_score</span> <span class='op'>==</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>bit_score</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>                                     <span class='va'>query_id</span><span class='op'>:</span><span class='va'>q_len</span>,<span class='va'>evalue</span>,<span class='va'>bit_score</span>,<span class='va'>scope</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># select only hits with a scope &gt; 0.1</span></span>
<span class='r-in'><span class='va'>Annot.HighMatches</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Annot</span>, <span class='va'>scope</span> <span class='op'>&gt;=</span> <span class='fl'>0.1</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Annotate the proportion of hits</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/barplot.html'>barplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/stringr/man/str_split.html'>str_split</a></span><span class='op'>(</span></span>
<span class='r-in'>        <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>Annot.HighMatches</span><span class='op'>$</span><span class='va'>subject_id</span><span class='op'>)</span><span class='op'>)</span>,<span class='st'>"_"</span><span class='op'>)</span>, </span>
<span class='r-in'>        <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, decreasing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hajk-Georg Drost.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


