<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filter the Repbase query output — repbase.filter • LTRpred</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Filter the Repbase query output — repbase.filter" />

<meta property="og:description" content="Filter the output of the repbase.query function to quantify
the number of hits for each query LTR transposon (duplicates) and retain
only hits found in Repbase that span the annotation sequence in Repbase
to a certain percentage (scope)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTRpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Introduction.html">Introduction to LTRpred</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/HajkD/LTRpred">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter the Repbase query output</h1>
    <small class="dont-index">Source: <a href='https://github.com/HajkD/LTRpred/blob/master/R/repbase.filter.R'><code>R/repbase.filter.R</code></a></small>
    <div class="hidden name"><code>repbase.filter.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Filter the output of the <code><a href='repbase.query.html'>repbase.query</a></code> function to quantify
the number of hits for each query LTR transposon (duplicates) and retain
only hits found in Repbase that span the annotation sequence in Repbase
to a certain percentage (<code>scope</code>).</p>
    
    </div>

    <pre class="usage"><span class='fu'>repbase.filter</span>(<span class='no'>query.output</span>, <span class='kw'>scope.value</span> <span class='kw'>=</span> <span class='fl'>0.7</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>query.output</th>
      <td><p>a <code>data.frame</code> returned by the <code><a href='repbase.query.html'>repbase.query</a></code> function.</p></td>
    </tr>
    <tr>
      <th>scope.value</th>
      <td><p>a value between [0,1] qunatifying the percentage of minimum sequence similariy 
between the LTR transposon and the corresponding annotated sequence found in Repbase.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>a logical value indicating whether or not additional information shall be printed 
to the console while executing this function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>data.frame</code> storing the filtered output returned by <code><a href='repbase.query.html'>repbase.query</a></code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='repbase.query.html'>repbase.query</a></code>, <code><a href='repbase.clean.html'>repbase.clean</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># PreProcess Repbase: A thaliana</span>
<span class='co'># and save the output into the file "Athaliana_repbase.ref"</span>
<span class='fu'><a href='repbase.clean.html'>repbase.clean</a></span>(<span class='kw'>repbase.file</span> <span class='kw'>=</span> <span class='st'>"athrep.ref"</span>,
              <span class='kw'>output.file</span>  <span class='kw'>=</span> <span class='st'>"Athaliana_repbase.ref"</span>)

<span class='co'># perform blastn search against A thaliana repbase annotation</span>
<span class='no'>AthalianaRepBaseAnnotation</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='repbase.query.html'>repbase.query</a></span>(<span class='kw'>ltr.seqs</span>     <span class='kw'>=</span> <span class='st'>"TAIR10_chr_all-ltrdigest_complete.fas"</span>,
                                           <span class='kw'>repbase.path</span> <span class='kw'>=</span> <span class='st'>"Athaliana_repbase.ref"</span>,
                                           <span class='kw'>cores</span>        <span class='kw'>=</span> <span class='fl'>1</span>)
 <span class='co'># filter the annotation query output                                           </span>
 <span class='no'>AthalianaAnnot.HighMatches</span> <span class='kw'>&lt;-</span> <span class='fu'>repbase.filter</span>(<span class='no'>AthalianaRepBaseAnnotation</span>,
                                              <span class='kw'>scope</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)
 <span class='no'>Ath.TE.Matches.Families</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sort'>sort</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/table'>table</a></span>(
                            <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlist'>unlist</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></span>(<span class='kw pkg'>stringr</span><span class='kw ns'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span>(
                            <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/table'>table</a></span>(<span class='no'>AthalianaAnnot.HighMatches</span>$<span class='no'>subject_id</span>)),<span class='st'>"_"</span>),
                            <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='no'>x</span>[<span class='fl'>2</span>:<span class='fl'>3</span>],<span class='kw'>collapse</span> <span class='kw'>=</span> <span class='st'>"."</span>)))),
                                        <span class='kw'>decreasing</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

 <span class='co'># visualize the hits found to have a scope of 90%</span>
 <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/barplot'>barplot</a></span>(<span class='no'>Ath.TE.Matches.Families</span>,
        <span class='kw'>las</span>       <span class='kw'>=</span> <span class='fl'>3</span>,
        <span class='kw'>cex.names</span> <span class='kw'>=</span> <span class='fl'>0.8</span>,
        <span class='kw'>col</span>       <span class='kw'>=</span> <span class='fu'><a href='bcolor.html'>bcolor</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>Ath.TE.Matches.Families</span>)),
        <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"RepBase Annotation: A. thaliana"</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Hajk-Georg Drost</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Hajk-Georg Drost.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

