<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to LTRpred • LTRpred</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to LTRpred">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTRpred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction to LTRpred</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HajkD/LTRpred">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to LTRpred</h1>
            
            <h4 class="date">2020-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HajkD/LTRpred/blob/master/vignettes/Introduction.Rmd"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div id="table-of-contents" class="section level1">
<h1 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of Contents</h1>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li>
<a href="#getting-started">2. Getting Started</a>
<ul>
<li><a href="#installation">2.1 Installation</a></li>
<li><a href="#quick-start">2.1 Quick Start</a></li>
<li><a href="#ltrpred-output">2.2 LTRpred output</a></li>
<li><a href="#import-ltrpred-output">2.3 Import LTRpred output</a></li>
<li><a href="#output-file-format-of-ltrpred">2.4 Output file format of LTRpred()</a></li>
</ul>
</li>
<li>
<a href="#detailed-ltrpred-run">3. Detailed LTRpred run</a>
<ul>
<li><a href="#hmm-models">3.1 HMM Models</a></li>
<li><a href="#detailed-description-of-adjustable-ltrpred-parameters">3.2 Detailed description of adjustable LTRpred parameters</a></li>
</ul>
</li>
<li><a href="#metagenome-scale-annotations">4. Metagenome scale annotations</a></li>
</ul>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>LTRpred</code> package implements a software pipeline and provides an integrated workflow to screen for intact and potentially active LTR retrotransposons in any genomic sequence of interest. For this purpose, this package provides a rich set of analytics tools to allow researchers to quickly start annotating and explore their own genomes.</p>
<p>The <em>de novo</em> prediction of LTR transposons in <code>LTRpred</code> is based on the command line tools <a href="http://www.zbh.uni-hamburg.de/?id=206">LTRharvest</a> and <a href="http://www.zbh.uni-hamburg.de/forschung/arbeitsgruppe-genominformatik/software/ltrdigest.html">LTRdigest</a> and extends these search strategies by additional analytics modules to filter the search space of putative LTR transposons for biologically meaningful candidates.</p>
<p>Please make sure that all command line tools are installed properly before running any <code>LTRpred</code> function.</p>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h1>
<p>The rational for implementing <code>LTRpred</code> was to implement an R based pipeline combining the most sensitive, accurate, and conservative state-of-the art LTR retrotransposon detection tools and extend their inference by additional analyses and quality filtering steps to screen for functional and structurally intact elements. Hence, <em>LTRpred</em> aims to provide a high-level <em>de novo</em> prediction infrastructure to generate high quality annotations of intact LTR retrotransposons. All <code>LTRpred</code> functions are generic so that parameters can be changed to detect any form of LTR retrotransposon in any genome.</p>
<p>Internally, <em>LTRpred</em> is based on the <code>de novo</code> annotation tools <code>LTRharvest</code> and <code>LTRdigest</code> which use prior knowledge about DNA sequence features (also referred to as <code>Structure-based methods</code>) such as the homology of Long Terminal Repeats (LTRs), Primer Binding Sites (PBS), <em>gag</em> and <em>pol</em> protein domains, and Target Site Duplications (TSDs) that are known to enable the process of transposition (<a href="http://bib.oxfordjournals.org/content/8/6/382.long">Bergman and Quesneville, 2007</a>) to infer LTR retrotransposons in any genome.</p>
<p>Hence, these <code>de novo</code> annotation tools are designed to screen the genome systematically and efficiently for these structural DNA features. <strong>Figure 1</strong> shows the structural features of LTR retrotransposons that are used for predicting putative LTR transposons <code>de novo</code> in any genome of interest.</p>
<div class="figure">
<img src="LTRfeatures.png" alt="Sequence features of LTR retrotransposons. The structural element (LTR length, LTR similarity, TSD, max. size of full LTR rertrotransposon, PBS length, tRNA binding, protein domain search, etc.) can be modified and controlled separately by corresponding arguments implemented in the LTRpred() function. In addition to controlling the structural features of candidate LTR retrotransposons, a open reading frame prediction, Dfam annotation, copy number clustering, and LTR copy number estimation, and methylation context quantification is performed subsequently after reporting putative LTR retrotransposons."><p class="caption">Sequence features of LTR retrotransposons. The structural element (LTR length, LTR similarity, TSD, max. size of full LTR rertrotransposon, PBS length, tRNA binding, protein domain search, etc.) can be modified and controlled separately by corresponding arguments implemented in the <code><a href="../reference/LTRpred.html">LTRpred()</a></code> function. In addition to controlling the structural features of candidate LTR retrotransposons, a open reading frame prediction, Dfam annotation, copy number clustering, and LTR copy number estimation, and methylation context quantification is performed subsequently after reporting putative LTR retrotransposons.</p>
</div>
<p>Based on the optimized output of these tools, the <code>LTRpred</code> package aims to provide researchers with maximum flexibility of adjustable parameters to detect any type of functional LTR retrotransposon. <code>LTRpred</code> package allows users to modify a vast range of parameters to screen for potential LTR transposons, so having this template shown in <strong>Figure 1</strong> in mind will help researchers to modify structural parameters in a biologically meaningful manner.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><strong>Note: please be aware that LTRpred is designed for Linux and Unix based systems such as macOS. Hence, although LTRpred itself can be installed on Windows machines, most of the command line tools LTRpred depends on cannot be installed on Windows machines.</strong></p>
<div id="programming-languages" class="section level3">
<h3 class="hasAnchor">
<a href="#programming-languages" class="anchor"></a>Programming Languages</h3>
<p>Please make sure that the following programming languages are installed on your system:</p>
<ul>
<li>Perl</li>
<li>Ruby</li>
<li>Python</li>
<li>C/C++</li>
<li>R</li>
</ul>
</div>
<div id="dependency-r-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#dependency-r-packages" class="anchor"></a>Dependency R packages</h3>
<p>Please make sure that <a href="https://www.bioconductor.org/install/">Bioconductor</a> and all package dependencies are installed on the system on which you would like to run <code>LTRpred</code>.</p>
<p>Install prerequisite CRAN and Bioconductor packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">    <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>()</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rtracklayer"</span>, <span class="st">"GenomicFeatures"</span>, <span class="st">"GenomicRanges"</span>, <span class="st">"GenomeInfoDb"</span>, <span class="st">"biomaRt"</span>, <span class="st">"Biostrings"</span>, <span class="st">"ggbio"</span>))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"tidyverse"</span>, <span class="st">"data.table"</span>, <span class="st">"seqinr"</span>, <span class="st">"biomartr"</span>, <span class="st">"ape"</span>, <span class="st">"dtplyr"</span>, <span class="st">"devtools"</span>))</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"HajkD/metablastr"</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BSDA"</span>, <span class="st">"ggrepel"</span>, <span class="st">"gridExtra"</span>)) </a></code></pre></div>
<p>Now users may install <code>LTRpred</code> as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"HajkD/LTRpred"</span>)</a></code></pre></div>
</div>
</div>
<div id="install-prerequisite-command-line-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#install-prerequisite-command-line-tools" class="anchor"></a>Install prerequisite command line tools</h2>
<p><strong>For the <code><a href="../reference/LTRpred.html">LTRpred::LTRpred()</a></code> function to run properly, please make sure that the following command line tools are installed on your system</strong>:</p>
<p><strong>We show examplified for macOS Sierra 10.12.6 how to install the individual tools. Please consult the installation documentation of the individual tools when you wish to install the command line tools for a different operating system than macOS Sierra. Please also make sure that you have sudo rights on the system you wish to install the following tools.</strong></p>
</div>
<div id="install-hmmer" class="section level2">
<h2 class="hasAnchor">
<a href="#install-hmmer" class="anchor"></a>Install <a href="http://hmmer.org/download.html">HMMER</a>
</h2>
<p>A detailed description of how to install <code>HMMER</code> for several operating systems can be found <a href="http://hmmer.org/download.html">here</a>.</p>
<div id="for-linux-systems" class="section level3">
<h3 class="hasAnchor">
<a href="#for-linux-systems" class="anchor"></a>For <code>Linux</code> systems:</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">wget</span> ftp://selab.janelia.org/pub/software/hmmer3/3.1b2/hmmer-3.1b2.tar.gz</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="fu">tar</span> xf hmmer-3.1b2.tar.gz</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="bu">cd</span> hmmer-3.1b2</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"> <span class="ex">./configure</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"> <span class="fu">make</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"> <span class="fu">make</span> check</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"> <span class="fu">sudo</span> make install</a></code></pre></div>
</div>
<div id="for-macos-systems" class="section level3">
<h3 class="hasAnchor">
<a href="#for-macos-systems" class="anchor"></a>For <code>macOS</code> systems:</h3>
<p>First install <a href="http://brew.sh/">Homebrew</a> by running the command:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ex">ruby</span> -e <span class="st">"</span><span class="va">$(</span><span class="ex">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="va">)</span><span class="st">"</span></a></code></pre></div>
<p>Then users can install the following dependencies:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ex">brew</span> install wget</a></code></pre></div>
<p>In case you have troubles installing <code>Homebrew</code> or some dependencies, please consult the <a href="https://docs.brew.sh/Common-Issues.html">Common issues</a> section of the <code>Homebrew</code> documentation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># download HMMER binary</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="fu">wget</span> http://eddylab.org/software/hmmer3/3.1b2/hmmer-3.1b2-macosx-intel.tar.gz</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="fu">tar</span> xf hmmer-3.1b2-macosx-intel.tar.gz</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="bu">cd</span> hmmer-3.1b2-macosx-intel</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"> <span class="ex">./configure</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"> <span class="fu">make</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"> <span class="fu">make</span> check</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"> <span class="fu">sudo</span> make install</a></code></pre></div>
</div>
</div>
<div id="install-genometools" class="section level2">
<h2 class="hasAnchor">
<a href="#install-genometools" class="anchor"></a>Install <a href="https://github.com/genometools/genometools">GenomeTools</a>
</h2>
<p>A detailed description of how to install <code>GenomeTools</code> for several operating systems can be found <a href="https://github.com/genometools/genometools/blob/master/INSTALL">here</a>.</p>
<p><strong>For now <code>LTRpred</code> is designed for <code>genome tools version 1.5.7</code> and might not run seamlessly with more recent versions. The adaptation of <code>LTRpred</code> to more recent <code>genome tools versions</code> is ongoing but will require a few more weeks.</strong></p>
<p>You can find out which <code>genome tools version</code> you installed by typing <code>gt -version</code> in your terminal (after installation).</p>
<p>Examplified for Linux or macOS users can run the following procedures:</p>
<div id="for-linux-systems-1" class="section level3">
<h3 class="hasAnchor">
<a href="#for-linux-systems-1" class="anchor"></a>For <code>Linux</code> systems</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="fu">wget</span> http://genometools.org/pub/genometools-1.5.9.tar.gz</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="fu">tar</span> -xf genometools-1.5.9.tar.gz</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="bu">cd</span> genometools-1.5.9</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="fu">make</span> with-hmmer=yes cairo=no </a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="fu">make</span> cairo=no test</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="fu">sudo</span> make cairo=no install</a></code></pre></div>
</div>
<div id="for-macos-systems-1" class="section level3">
<h3 class="hasAnchor">
<a href="#for-macos-systems-1" class="anchor"></a>For <code>macOS</code> systems</h3>
<p>First install <a href="http://brew.sh/">Homebrew</a> by running the command:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ex">ruby</span> -e <span class="st">"</span><span class="va">$(</span><span class="ex">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="va">)</span><span class="st">"</span></a></code></pre></div>
<p>Then users can install the following dependencies:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># install dependencies</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="ex">brew</span> tap caskroom/cask</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="ex">brew</span> cask install xquartz</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="ex">brew</span> install cairo</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="ex">brew</span> install pango</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="ex">brew</span> install wget</a></code></pre></div>
<p>In case you have troubles installing <code>Homebrew</code> or some dependencies, please consult the <a href="https://docs.brew.sh/Common-Issues.html">Common issues</a> section of the <code>Homebrew</code> documentation.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># install genometools</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># download from http://genometools.org/pub/genometools-1.5.9.tar.gz</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="fu">wget</span> http://genometools.org/pub/genometools-1.5.9.tar.gz</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="fu">tar</span> -xf genometools-1.5.9.tar.gz</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="bu">cd</span> genometools-1.5.9</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="fu">make</span> with-hmmer=yes cairo=no </a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="fu">make</span> cairo=no test</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="fu">sudo</span> make cairo=no install</a></code></pre></div>
<p>In case you have problems or issues installing <code>GenomeTools</code> please consult the <a href="https://github.com/genometools/genometools/blob/master/INSTALL">installation</a> documentation.</p>
</div>
</div>
<div id="install-usearch" class="section level2">
<h2 class="hasAnchor">
<a href="#install-usearch" class="anchor"></a>Install <a href="http://drive5.com/usearch/download.html">USEARCH</a>
</h2>
<p>A detailed description of how to install <code>USEARCH</code> for several operating systems can be found <a href="http://drive5.com/usearch/manual/install.html">here</a>.</p>
<p>First, users will need to register and download USEARCH for their operating system from <a href="http://drive5.com/usearch/download.html" class="uri">http://drive5.com/usearch/download.html</a> .</p>
<p>After downloading USEARCH you will need to install it as a command line tool in your <code>/usr/local/</code> directory and you should be able to execute the following command in your Terminal:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="ex">usearch</span> -version</a></code></pre></div>
<pre><code>usearch v8.1.1861_i86osx32</code></pre>
<p>Otherwise, <code>usearch</code> is not properly installed on your system and <code><a href="../reference/LTRpred.html">LTRpred()</a></code> will not be able to run seamlessly.</p>
<div id="example-for-macos" class="section level3">
<h3 class="hasAnchor">
<a href="#example-for-macos" class="anchor"></a>Example for macOS:</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># register and download operating system specific usearch from</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># http://drive5.com/usearch/download.html</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co"># After download run:</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="fu">chmod</span> +x usearch10.0.240_i86osx32</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="fu">sudo</span> cp usearch10.0.240_i86osx32 /usr/local/bin/</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="fu">sudo</span> mv /usr/local/bin/usearch10.0.240_i86osx32 /usr/local/bin/usearch</a></code></pre></div>
<p>In case you have problems or issues installing <code>USEARCH</code> please consult the <a href="http://drive5.com/usearch/">USEARCH documentation</a> documentation.</p>
</div>
</div>
<div id="install-vsearch" class="section level2">
<h2 class="hasAnchor">
<a href="#install-vsearch" class="anchor"></a>Install <a href="https://github.com/torognes/vsearch">VSEARCH</a>
</h2>
<p>A detailed description of how to install <code>VSEARCH</code> for several operating systems can be found <a href="https://github.com/torognes/vsearch">here</a>.</p>
<p>Please <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">install git</a> before running the following commands.</p>
<div id="example-for-linux-systems" class="section level3">
<h3 class="hasAnchor">
<a href="#example-for-linux-systems" class="anchor"></a>Example for Linux systems:</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="fu">sudo</span> apt-get install git autotools-dev</a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="fu">sudo</span> git clone https://github.com/torognes/vsearch.git</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="bu">cd</span> vsearch</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="fu">sudo</span> ./autogen.sh</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="fu">sudo</span> ./configure</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="fu">sudo</span> make</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="fu">sudo</span> make install</a></code></pre></div>
</div>
<div id="example-for-macos-systems" class="section level3">
<h3 class="hasAnchor">
<a href="#example-for-macos-systems" class="anchor"></a>Example for macOS systems:</h3>
<p>First install <a href="http://brew.sh/">Homebrew</a> by running the command:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="ex">ruby</span> -e <span class="st">"</span><span class="va">$(</span><span class="ex">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="va">)</span><span class="st">"</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="ex">brew</span> install autoconf</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="ex">brew</span> install automake</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="fu">sudo</span> git clone https://github.com/torognes/vsearch.git</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="bu">cd</span> vsearch</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="fu">sudo</span> ./autogen.sh</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="fu">sudo</span> ./configure</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="fu">sudo</span> make</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="fu">sudo</span> make install</a></code></pre></div>
<p>In case you have problems or issues installing <code>VSEARCH</code> please consult the <a href="https://github.com/Pas-Kapli/tutorials/wiki/vsearch">VSEARCH documentation</a> documentation.</p>
</div>
</div>
<div id="blast" class="section level2">
<h2 class="hasAnchor">
<a href="#blast" class="anchor"></a><a href="https://www.ncbi.nlm.nih.gov/books/NBK279671/">BLAST</a>
</h2>
<p>A detailed description of how to install <code>BLAST</code> for several operating systems can be found <a href="https://www.ncbi.nlm.nih.gov/books/NBK279671/">here</a>.</p>
<div id="linux-example" class="section level3">
<h3 class="hasAnchor">
<a href="#linux-example" class="anchor"></a>Linux Example</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># download BLAST+ version 2.7.1</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="fu">wget</span> </a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="ex">ftp</span>://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.7.1/ncbi-blast-2.7.1+-x64-linux.tar.gz</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co"># extract the compiled version of BLAST</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="fu">tar</span> zxvpf ncbi-blast-2.7.1+-x64-linux.tar.gz</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co"># copy BLAST files to `usr/local/bin`</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="fu">cp</span> ncbi-blast-2.7.1+/bin/* usr/local/bin</a></code></pre></div>
<p>Alternatively users can set the system call to the BLAST programs by specifying the PATH variable (this is useful, because it allows an easier update of BLAST versions instead of deleting all BLAST programs from usr/local/bin):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co"># open vim text editor</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="ex">vi</span> .bash_profile</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co"># type 'Shift' then I to edit the file .bash_profile</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co"># and specify the export PATH</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="bu">export</span> <span class="va">PATH=${PATH}</span>:/path/to/downloaded/blast/folder/ncbi-blast-2.7.1+/bin</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co"># type 'ESC' then ':' then 'w' then 'q' to save and quit the .bash_profile file </span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co"># log out from your server with</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="bu">exit</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co"># log in again and type</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="ex">blastp</span> -version</a></code></pre></div>
<p>Now users should see the BLAST command line options.</p>
</div>
<div id="macos-example" class="section level3">
<h3 class="hasAnchor">
<a href="#macos-example" class="anchor"></a>macOS Example</h3>
<p>Download the file <code>ncbi-blast-2.7.1+.dmg</code> from <a href="ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.7.1/" class="uri">ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.7.1/</a> and run the excecutable.</p>
</div>
<div id="install-perl" class="section level3">
<h3 class="hasAnchor">
<a href="#install-perl" class="anchor"></a>Install <a href="https://www.perl.org/">Perl</a>
</h3>
<p>Please follow the instructions at <a href="https://learn.perl.org/installing/" class="uri">https://learn.perl.org/installing/</a>.</p>
<p>After installation, you should be able to execute the following command on the terminal:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="fu">perl</span> -v</a></code></pre></div>
<pre><code>This is perl 5, version 18, subversion 2 (v5.18.2) built for darwin-thread-multi-2level
(with 2 registered patches, see perl -V for more detail)

Copyright 1987-2013, Larry Wall

Perl may be copied only under the terms of either the Artistic License or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using "man perl" or "perldoc perl".  If you have access to the
Internet, point your browser at http://www.perl.org/, the Perl Home Page.</code></pre>
</div>
<div id="install-dfamscan-pl" class="section level3">
<h3 class="hasAnchor">
<a href="#install-dfamscan-pl" class="anchor"></a>Install <a href="http://www.dfam.org/web_download/Current_Release/dfamscan.pl">dfamscan.pl</a>
</h3>
<p><a href="https://www.dfam.org/releases/Dfam_3.1/infrastructure/dfamscan.pl.gz">dfamscan.pl</a> needs to be unzipped and stored at <code>/usr/local/bin/dfamscan.pl</code> and executabe via <code>perl /usr/local/bin/dfamscan.pl -help</code>. This is important to be able to run the hmmer search against the Dfam database.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="fu">wget</span> https://www.dfam.org/releases/Dfam_3.1/infrastructure/dfamscan.pl.gz</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="fu">gunzip</span> dfamscan.pl.gz</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="fu">sudo</span> cp dfamscan.pl /usr/local/bin/dfamscan.pl</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co"># test whether it worked</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="fu">perl</span> /usr/local/bin/dfamscan.pl -help</a></code></pre></div>
<p>Users can download the <a href="https://www.dfam.org/releases/Dfam_3.1/families/">Dfam database v3.1</a> by running:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="fu">wget</span> https://www.dfam.org/releases/Dfam_3.1/families/Dfam.hmm.gz</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="fu">gunzip</span> Dfam.hmm.gz</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co"># run hmmpress</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="ex">hmmpress</span> Dfam.hmm</a></code></pre></div>
</div>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>The fastest way to generate a LTR retrotransposon prediction for a genome of interest (after <a href="Install.Rmd">installing</a> all prerequisite command line tools) is to use the <code><a href="../reference/LTRpred.html">LTRpred()</a></code> function and relying on the default parameters. In the following example, a LTR transposon prediction is performed for parts of the Human Y chromosome.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># load LTRpred package</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(LTRpred)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co"># de novo LTR transposon prediction for the Human Y chromosome</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="kw"><a href="../reference/LTRpred.html">LTRpred</a></span>(</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">    <span class="dt">genome.file =</span> <span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"Hsapiens_ChrY.fa"</span>, <span class="dt">package =</span> <span class="st">"LTRpred"</span>),</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">    <span class="dt">cores =</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7">)</a></code></pre></div>
<pre><code>Running LTRpred on genome '/Library/Frameworks/R.framework/Versions/3.6/Resources/library/LTRpred/Hsapiens_ChrY.fa' with 4 core(s) and searching for retrotransposons using the overlaps option (overlaps = 'no') ...


No hmm files were specified, thus the internal HMM library will be used! See '/Library/Frameworks/R.framework/Versions/3.6/Resources/library/LTRpred/HMMs/hmm_*' for details.
No tRNA files were specified, thus the internal tRNA library will be used! See '/Library/Frameworks/R.framework/Versions/3.6/Resources/library/LTRpred/tRNAs/tRNA_library.fa' for details.
The output folder 'Hsapiens_ChrY_ltrpred' seems to exist already and will be used to store LTRpred results ...


LTRpred - Step 1:
Run LTRharvest...
LTRharvest: Generating index file Hsapiens_ChrY_ltrharvest/Hsapiens_ChrY_index.fsa with gt suffixerator...
Running LTRharvest and writing results to Hsapiens_ChrY_ltrharvest...
LTRharvest analysis finished!


LTRpred - Step 2:
Generating index file Hsapiens_ChrY_ltrdigest/Hsapiens_ChrY_index_ltrdigest.fsa with suffixerator...
LTRdigest: Sort index file...
Running LTRdigest and writing results to Hsapiens_ChrY_ltrdigest...
LTRdigest analysis finished!


LTRpred - Step 3:
Import LTRdigest Predictions...

Input:  Hsapiens_ChrY_ltrdigest/Hsapiens_ChrY_LTRdigestPrediction.gff  -&gt; Row Number:  179
Remove 'NA' -&gt; New Row Number:  179
(1/8) Filtering for repeat regions has been finished.
(2/8) Filtering for LTR retrotransposons has been finished.
(3/8) Filtering for inverted repeats has been finished.
(4/8) Filtering for LTRs has been finished.
(5/8) Filtering for target site duplication has been finished.
(6/8) Filtering for primer binding site has been finished.
(7/8) Filtering for protein match has been finished.
(8/8) Filtering for RR tract has been finished.


LTRpred - Step 4:
Perform ORF Prediction using 'usearch -fastx_findorfs' ...
usearch v8.1.1861_i86osx32, 4.0Gb RAM (17.2Gb total), 8 cores
(C) Copyright 2013-15 Robert C. Edgar, all rights reserved.
http://drive5.com/usearch

00:00 1.9Mb  100.0% Working
Join ORF Prediction table: nrow(df) = 24 candidates.
unique(ID) = 24 candidates.
unique(orf.id) = 24 candidates.


LTRpred - Step 5:
Perform methylation context quantification..
Join methylation context (CG, CHG, CHH, CCG) count table: nrow(df) = 24 candidates.
unique(ID) = 24 candidates.
unique(orf.id) = 24 candidates.
Copy files to result folder 'Hsapiens_ChrY_ltrpred'.


LTRpred - Step 6:
Starting retrotransposon evolutionary age estimation by comparing the 3' and 5' LTRs using the molecular evolution model 'K80' and the mutation rate '1.3e-07' (please make sure the mutation rate can be assumed for your species of interest!) for 24 predicted elements ...


Please be aware that evolutionary age estimation based on 3' and 5' LTR comparisons are only very rough time estimates and don't take reverse-transcription mediated retrotransposon recombination between family members of retroelements into account! Please consult Sanchez et al., 2017 Nature Communications and Drost &amp; Sanchez, 2019 Genome Biology and Evolution for more details on retrotransposon recombination.


LTRpred - Step 7:
The LTRpred prediction table has been filtered (default) to remove potential false positives. Predicted LTRs must have an PBS or Protein Domain and must fulfill thresholds: sim = 70%; #orfs = 0. Furthermore, TEs having more than 10% of N's in their sequence have also been removed.
Input #TEs: 24
Output #TEs: 21

LTRpred finished all analyses successfully. All output files were stored at 'Hsapiens_ChrY_ltrpred'.
[1] "Successful job 1 ."</code></pre>
<div id="ltrpred-output" class="section level3">
<h3 class="hasAnchor">
<a href="#ltrpred-output" class="anchor"></a>LTRpred output</h3>
<p>The <code><a href="../reference/LTRpred.html">LTRpred()</a></code> function internally generates a folder named <code>*_ltrpred</code> which stores all output annotation and sequence files.</p>
<p>In detail, the following files and folders are generated by the <code><a href="../reference/LTRpred.html">LTRpred()</a></code> function:</p>
<ul>
<li>
<strong>Folder <code>*_ltrpred</code></strong>
<ul>
<li><p><code>*_ORF_prediction_nt.fsa</code> : Stores the predicted open reading frames within the predicted LTR transposons as DNA sequence.</p></li>
<li><p><code>*_ORF_prediction_aa.fsa</code> : Stores the predicted open reading frames within the predicted LTR transposons as protein sequence.</p></li>
<li><p><code>*_LTRpred.gff</code> : Stores the LTRpred predicted LTR transposons in GFF format.</p></li>
<li><p><code>*_LTRpred.bed</code> : Stores the LTRpred predicted LTR transposons in BED format.</p></li>
<li>
<code>*_LTRpred_DataSheet.tsv</code> : Stores the output table as data sheet.</li>
<li>
<strong>Folder <code>*_ltrharvest</code></strong>
<ul>
<li><p><code>*_ltrharvest/*_BetweenLTRSeqs.fsa</code> : DNA sequences of the region between the LTRs in fasta format.</p></li>
<li><p><code>*_ltrharvest/*_Details.tsv</code> : A spread sheet containing detailed information about the predicted LTRs.</p></li>
<li><p><code>*_ltrharvest/*_FullLTRRetrotransposonSeqs.fsa</code> : DNA sequences of the entire predicted LTR retrotransposon.</p></li>
<li><p><code>*_ltrharvest/*_index.fsa</code> : The suffixarray index file used to predict putative LTR retrotransposons.</p></li>
<li><p><code>*_ltrharvest/*_Prediction.gff</code> : A spread sheet containing detailed additional information about the predicted LTRs (partially redundant with the *_Details.tsv file).</p></li>
<li><p><code>*_ltrdigest/*_index_ltrdigest.fsa</code> : The suffixarray index file used to predict putative LTR retrotransposonswith LTRdigest.</p></li>
</ul>
</li>
<li>
<strong>Folder <code>*_ltrdigest</code></strong>
<ul>
<li><p><code>*_ltrdigest/*_LTRdigestPrediction.gff</code> : A spread sheet containing detailed information about the predicted LTRs.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_tabout.csv</code> : A spread sheet containing additional detailed information about the predicted LTRs.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_complete.fas</code> : The full length DNA sequences of all predicted LTR transposons.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_conditions.csv</code> : Contains information about the parameters used for a given LTRdigest run.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_pbs.fas</code> : Stores the predicted PBS sequences for the putative LTR retrotransposons.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_ppt.fas</code> : Stores the predicted PPT sequences for the putative LTR retrotransposons.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_5ltr.fas</code> and <code>*-ltrdigest_3ltr.fas</code>: Stores the predicted 5’ and 3’ LTR sequences. Note: If the direction of the putative retrotransposon could be predicted, these files will contain the corresponding 3’ and 5’ LTR sequences. If no direction could be predicted, forward direction with regard to the original sequence will be assumed by LTRdigest, i.e. the ‘left’ LTR will be considered the 5’ LTR.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_pdom_&lt;domainname&gt;.fas</code> : Stores the DNA sequences of the HMM matches to the LTR retrotransposon candidates.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_pdom_&lt;domainname&gt;_aa.fas</code> : Stores the concatenated protein sequences of the HMM matches to the LTR retrotransposon candidates.</p></li>
<li><p><code>*_ltrdigest/*-ltrdigest_pdom_&lt;domainname&gt;_ali.fas</code> : Stores the alignment information for all matches of the given protein domain model to the translations of all candidates.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="import-ltrpred-output" class="section level3">
<h3 class="hasAnchor">
<a href="#import-ltrpred-output" class="anchor"></a>Import LTRpred output</h3>
<p>The <code><a href="../reference/LTRpred.html">LTRpred()</a></code> output table <code>*_LTRpred_DataSheet.tsv</code> is in <a href="http://vita.had.co.nz/papers/tidy-data.html">tidy</a> format and can then be imported using <code><a href="../reference/read.ltrpred.html">read.ltrpred()</a></code>. The <code>tidy</code> output format is designed to work seamlessly with the <a href="https://www.tidyverse.org/">tidyverse</a> and <a href="http://r4ds.had.co.nz/">R data science</a> framework.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># import LTRpred prediction output</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">Hsapiens_chrY &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.ltrpred.html">read.ltrpred</a></span>(<span class="st">"Hsapiens_ChrY_ltrpred/Hsapiens_ChrY_LTRpred_DataSheet.tsv"</span>)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co"># look at some results</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4">dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(Hsapiens_chrY, ltr_similarity<span class="op">:</span>end, tRNA_motif, Clust_cn)</a></code></pre></div>
<pre><code># A tibble: 14 x 9
   ltr_similarity similarity protein_domain  orfs        chromosome
            &lt;dbl&gt;      &lt;chr&gt;          &lt;chr&gt; &lt;int&gt;             &lt;chr&gt;
 1          80.73    (80,82]          RVT_1     1 NC000024.10Homosa
 2          89.85    (88,90]          RVT_1     1 NC000024.10Homosa
 3          79.71    (78,80]           &lt;NA&gt;     0 NC000024.10Homosa
 4          84.93    (84,86]          RVT_1     0 NC000024.10Homosa
 5          75.52       &lt;NA&gt;          RVT_1     0 NC000024.10Homosa
 6          76.47    [76,78]          RVT_1     1 NC000024.10Homosa
 7          80.28    (80,82]           &lt;NA&gt;     0 NC000024.10Homosa
 8          76.92    [76,78]          RVT_1     0 NC000024.10Homosa
 9          89.53    (88,90]          RVT_1     0 NC000024.10Homosa
10          93.57    (92,94]          RVT_1     1 NC000024.10Homosa
11          82.35    (82,84]          RVT_1     2 NC000024.10Homosa
12          79.51    (78,80]          RVT_1     0 NC000024.10Homosa
13          78.42    (78,80]          RVT_1     3 NC000024.10Homosa
14          92.75    (92,94]          RVT_1     1 NC000024.10Homosa
# ... with 4 more variables: start &lt;int&gt;, end &lt;int&gt;, tRNA_motif &lt;chr&gt;,
#   Clust_cn &lt;int&gt;</code></pre>
<p>Looking at all columns:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(Hsapiens_chrY)</a></code></pre></div>
<pre><code>Observations: 21
Variables: 92
$ species                 &lt;chr&gt; "Hsapiens_ChrY", "Hsapien...
$ ID                      &lt;chr&gt; "Hsapiens_ChrY_LTR_retrot...
$ dfam_target_name        &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ ltr_similarity          &lt;dbl&gt; 80.73, 89.85, 79.71, 83.2...
$ ltr_age_mya             &lt;dbl&gt; 0.7936246, 0.2831139, 0.7...
$ similarity              &lt;chr&gt; "(80,82]", "(88,90]", "(7...
$ protein_domain          &lt;chr&gt; "RVT_1", "RVT_1", NA, NA,...
$ orfs                    &lt;int&gt; 1, 1, 0, 0, 0, 0, 0, 1, 0...
$ chromosome              &lt;chr&gt; "NC000024.10Homosa", "NC0...
$ start                   &lt;int&gt; 3143582, 3275798, 3313536...
$ end                     &lt;int&gt; 3162877, 3299928, 3318551...
$ strand                  &lt;chr&gt; "-", "-", "+", "+", "-", ...
$ width                   &lt;int&gt; 19296, 24131, 5016, 12952...
$ annotation              &lt;chr&gt; "LTR_retrotransposon", "L...
$ pred_tool               &lt;chr&gt; "LTRpred", "LTRpred", "LT...
$ frame                   &lt;chr&gt; ".", ".", ".", ".", ".", ...
$ score                   &lt;chr&gt; ".", ".", ".", ".", ".", ...
$ lLTR_start              &lt;int&gt; 3143582, 3275798, 3313536...
$ lLTR_end                &lt;int&gt; 3143687, 3276408, 3313665...
$ lLTR_length             &lt;int&gt; 106, 611, 130, 126, 218, ...
$ rLTR_start              &lt;int&gt; 3162769, 3299338, 3318414...
$ rLTR_end                &lt;int&gt; 3162877, 3299928, 3318551...
$ rLTR_length             &lt;int&gt; 109, 591, 138, 137, 219, ...
$ lTSD_start              &lt;int&gt; 3143578, 3275794, 3313532...
$ lTSD_end                &lt;int&gt; 3143581, 3275797, 3313535...
$ lTSD_motif              &lt;chr&gt; "acag", "ttgt", "ttag", "...
$ rTSD_start              &lt;int&gt; 3162878, 3299929, 3318552...
$ rTSD_end                &lt;int&gt; 3162881, 3299932, 3318555...
$ rTSD_motif              &lt;chr&gt; "acag", "ttgt", "ttag", "...
$ PPT_start               &lt;int&gt; NA, NA, NA, NA, NA, 34660...
$ PPT_end                 &lt;int&gt; NA, NA, NA, NA, NA, 34660...
$ PPT_motif               &lt;chr&gt; NA, NA, NA, NA, NA, "agag...
$ PPT_strand              &lt;chr&gt; NA, NA, NA, NA, NA, "+", ...
$ PPT_offset              &lt;int&gt; NA, NA, NA, NA, NA, 23, N...
$ PBS_start               &lt;int&gt; NA, NA, 3313667, 3372512,...
$ PBS_end                 &lt;int&gt; NA, NA, 3313677, 3372522,...
$ PBS_strand              &lt;chr&gt; NA, NA, "+", "+", "-", "+...
$ tRNA                    &lt;chr&gt; NA, NA, "Homo_sapiens_tRN...
$ tRNA_motif              &lt;chr&gt; NA, NA, "aattagctgga", "c...
$ PBS_offset              &lt;int&gt; NA, NA, 1, 3, 0, 5, 2, 5,...
$ tRNA_offset             &lt;int&gt; NA, NA, 1, 0, 2, 5, 1, 5,...
$ `PBS/tRNA_edist`        &lt;int&gt; NA, NA, 1, 1, 1, 1, 1, 1,...
$ orf.id                  &lt;chr&gt; "NC000024.10Homosa_314358...
$ repeat_region_length    &lt;int&gt; 19304, 24139, 5024, 12960...
$ PPT_length              &lt;int&gt; NA, NA, NA, NA, NA, 27, N...
$ PBS_length              &lt;int&gt; NA, NA, 11, 11, 11, 11, 1...
$ dfam_acc                &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_bits               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_e_value            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_bias               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_hmm-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_hmm-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_strand             &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_ali-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_ali-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_env-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_env-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_modlen             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_target_description &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ Clust_Cluster           &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ Clust_Target            &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ Clust_Perc_Ident        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ Clust_cn                &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ TE_CG_abs               &lt;dbl&gt; 62, 125, 35, 70, 139, 83,...
$ TE_CG_rel               &lt;dbl&gt; 0.003213101, 0.005180059,...
$ TE_CHG_abs              &lt;dbl&gt; 659, 830, 150, 396, 742, ...
$ TE_CHG_rel              &lt;dbl&gt; 0.03415216, 0.03439559, 0...
$ TE_CHH_abs              &lt;dbl&gt; 2571, 3454, 748, 1743, 31...
$ TE_CHH_rel              &lt;dbl&gt; 0.1332400, 0.1431354, 0.1...
$ TE_CCG_abs              &lt;dbl&gt; 13, 24, 6, 15, 33, 16, 4,...
$ TE_CCG_rel              &lt;dbl&gt; 0.0006737148, 0.000994571...
$ TE_N_abs                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CG_3ltr_abs             &lt;dbl&gt; 1, 0, 1, 4, 8, 3, 1, 11, ...
$ CG_3ltr_rel             &lt;dbl&gt; 0.009433962, 0.000000000,...
$ CHG_3ltr_abs            &lt;dbl&gt; 2, 24, 9, 8, 14, 14, 9, 9...
$ CHG_3ltr_rel            &lt;dbl&gt; 0.01886792, 0.03927987, 0...
$ CHH_3ltr_abs            &lt;dbl&gt; 18, 69, 18, 26, 43, 70, 2...
$ CHH_3ltr_rel            &lt;dbl&gt; 0.16981132, 0.11292962, 0...
$ CCG_3ltr_abs            &lt;dbl&gt; 0, 0, 0, 2, 2, 0, 1, 4, 5...
$ CCG_3ltr_rel            &lt;dbl&gt; 0.000000000, 0.000000000,...
$ N_3ltr_abs              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CG_5ltr_abs             &lt;dbl&gt; 1, 0, 1, 4, 8, 3, 1, 11, ...
$ CG_5ltr_rel             &lt;dbl&gt; 0.009433962, 0.000000000,...
$ CHG_5ltr_abs            &lt;dbl&gt; 2, 24, 9, 8, 14, 14, 9, 9...
$ CHG_5ltr_rel            &lt;dbl&gt; 0.01886792, 0.03927987, 0...
$ CHH_5ltr_abs            &lt;dbl&gt; 18, 69, 18, 26, 43, 70, 2...
$ CHH_5ltr_rel            &lt;dbl&gt; 0.16981132, 0.11292962, 0...
$ CCG_5ltr_abs            &lt;dbl&gt; 0, 0, 0, 2, 2, 0, 1, 4, 5...
$ CCG_5ltr_rel            &lt;dbl&gt; 0.000000000, 0.000000000,...
$ N_5ltr_abs              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ cn_3ltr                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ cn_5ltr                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...</code></pre>
</div>
<div id="output-file-format-of-ltrpred" class="section level3">
<h3 class="hasAnchor">
<a href="#output-file-format-of-ltrpred" class="anchor"></a>Output file format of <code>LTRpred()</code>
</h3>
<p>The columns of the prediction file store the following information:</p>
<p>tidy format (each row contains all information for a predicted LTR retrotransposon):</p>
<ul>
<li>
<code>species</code> : Name of the species or genomic sequence that is passed as input to <code>LTRpred</code>
</li>
<li>
<code>ID</code> : unique identifier that is generated by <code>LTRpred</code> to mark individual LTR retrotransposon predictions</li>
<li>
<code>dfam_target_name</code> : name of hmmer search match in Dfam database (see <a href="#hmm-models">LTRpred HMM Models</a> for details)</li>
<li>
<code>ltr_similarity</code> : sequence similarity (global alignment) between the 5’ and 3’ long terminal repeat (LTR)</li>
<li>
<code>ltr_age_mya</code>: Rough estimation of retrotransposon insertion age in Mya based on 5 prime and 3 prime LTR sequence homology</li>
<li>
<code>ltr_evo_distance</code>: the molecular evolutionary distance value returned by the <code>evolutionary model</code> (e.g. Kimura-2P-Model) used to estamate DNA distances</li>
<li>
<code>similarity</code>: <code>ltr_similarity</code> classified into 2% intervals</li>
<li>
<code>chromosome</code> : chromosome at which LTR retrotransposon was found</li>
<li>
<code>start</code> : start coordinate of the LTR retrotransposon within the chromosome</li>
<li>
<code>end</code> : end coordinate of the LTR retrotransposon within the chromosome</li>
<li>
<code>strand</code> : strand on which the corresponding LTR retrotransposon was found</li>
<li>
<code>dfam_acc</code> : Dfam accession</li>
<li>
<code>width</code> : length/width of the LTR retrotransposon</li>
<li>
<code>orfs</code> : number of predicted open reading frames within the LTR retrotransposon sequence</li>
<li>
<code>protein_domain</code> : name of protein domains found between the 5’ and 3’ LTRs (see <a href="#hmm-models">LTRpred HMM Models</a> for details)</li>
<li>
<code>Clust_Cluster</code> : cluster identifier</li>
<li>
<code>Clust_Target</code> : LTR retrotransposon identifier that builds the cluster center of cluster <code>Clust_Cluster</code>
</li>
<li>
<code>Clust_Perc_Ident</code> : sequence similarity (global alignment) with <code>Clust_Target</code>
</li>
<li>
<code>Clust_cn</code> : number of LTR retrotransposon that belong to the same cluster (see <code>Clust_Target</code>) - if <code>Clust_cn</code> = 1 -&gt; unique element</li>
<li>
<code>lLTR_start</code> : start coordinate of the 5’ LTR within the chromosome</li>
<li>
<code>lLTR_end</code> : end coordinate of the 5’ LTR within the chromosome</li>
<li>
<code>lLTR_length</code> : length/width of the 5’ LTR</li>
<li>
<code>rLTR_start</code> : start coordinate of the 3’ LTR within the chromosome</li>
<li>
<code>rLTR_end</code> : end coordinate of the 3’ LTR within the chromosome</li>
<li>
<code>rLTR_length</code> : length/width of the 3’ LTR</li>
<li>
<code>lTSD_start</code> : start coordinate of the 5’ target site duplication (TSD) within the chromosome</li>
<li>
<code>lTSD_end</code> : end coordinate of the 5’ target site duplication (TSD) within the chromosome</li>
<li>
<code>lTSD_motif</code> : 5’ TSD sequence motif</li>
<li>
<code>PPT_start</code> : start coordinate of the PPT motif within the chromosome</li>
<li>
<code>PPT_end</code> : end coordinate of the PPT motif within the chromosome</li>
<li>
<code>PPT_motif</code> : PPT sequence motif</li>
<li>
<code>PPT_strand</code> : strand of PPT sequence</li>
<li>
<code>PPT_offset</code> : width between <code>PPT_end</code> and <code>rLTR_start</code>
</li>
<li>
<code>PBS_start</code> : start coordinate of the PBS motif within the chromosome</li>
<li>
<code>PBS_end</code> : end coordinate of the PBS motif within the chromosome</li>
<li>
<code>PBS_strand</code> : strand of PBS sequence</li>
<li>
<code>tRNA</code> : name of tRNA that matches PBS sequence</li>
<li>
<code>tRNA_motif</code> : tRNA sequence motif</li>
<li>
<code>PBS_offset</code> : width between <code>lLTR_end</code> and <code>PBS_start</code>
</li>
<li>
<code>tRNA_offset</code> : number of nucleotide that are allowed for tRNA to offset the PBS</li>
<li>
<code>PBS/tRNA_edist</code> : edit distance between tRNA motif and PBS motif</li>
<li>
<code>PPT_length</code> : length/width of the PPT motif</li>
<li>
<code>PBS_length</code> : length/width of the PBS motif</li>
<li>
<code>dfam_target_description</code> : description of Dfam target hit</li>
<li>
<code>orf.id</code> : id generated by ORF prediction</li>
<li>
<code>TE_CG_abs</code> : total number of CG motifs found within the full length LTR retrotransposon sequence</li>
<li>
<code>TE_CG_rel</code> : relative number of CG motifs found within the full length LTR retrotransposon (normalized by element length - <code>width</code>)</li>
<li>
<code>TE_CHG_abs</code> : total number of CHG motifs found within the full length LTR retrotransposon sequence</li>
<li>
<code>TE_CHG_rel</code> : relative number of CHG motifs found within the full length LTR retrotransposon sequence (normalized by element length - <code>width</code>)</li>
<li>
<code>TE_CHH_abs</code> : total number of CHH motifs found within the full length LTR retrotransposon sequence</li>
<li>
<code>TE_CHH_rel</code> : relative number of CHH motifs found within the full length LTR retrotransposon sequence (normalized by element length - <code>width</code>)</li>
<li>
<code>TE_N_abs</code> : total number of N’s found within the full length LTR retrotransposon sequence</li>
<li>
<code>CG_3ltr_abs</code> : total number of CG motifs found within only the 3’ LTR sequence</li>
<li>
<code>CG_3ltr_rel</code> : relative number of CG motifs found within only the 3’ LTR sequence (normalized by LTR length)</li>
<li>
<code>CHG_3ltr_abs</code> : total number of CHG motifs found within only the 3’ LTR sequence</li>
<li>
<code>CHG_3ltr_rel</code> : relative number of CHG motifs found within only the 3’ LTR sequence (normalized by LTR length)</li>
<li>
<code>CHH_3ltr_abs</code> : total number of CHH motifs found within only the 3’ LTR sequence</li>
<li>
<code>CG_5ltr_abs</code> : total number of CG motifs found within only the 5’ LTR sequence</li>
<li>
<code>CG_5ltr_rel</code> : relative number of CG motifs found within only the 5’ LTR sequence (normalized by LTR length)</li>
<li>
<code>N_3ltr_abs</code> : total number of N’s found within only the 3’ LTR sequence</li>
<li>
<code>CHG_5ltr_abs</code> : total number of CHG motifs found within only the 5’ LTR sequence</li>
<li>
<code>CHG_5ltr_rel</code> : relative number of CHG motifs found within only the 5’ LTR sequence (normalized by LTR length)</li>
<li>
<code>CHH_5ltr_abs</code> : total number of CHH motifs found within only the 5’ LTR sequence</li>
<li>
<code>CHH_5ltr_rel</code> : relative number of CHH motifs found within only the 5’ LTR sequence (normalized by LTR length)</li>
<li>
<code>N_5ltr_abs</code> : total number of N’s found within only the 5’ LTR sequence</li>
<li>
<code>cn_3ltr</code> : number of solo 3’ LTRs found in the genome</li>
<li>
<code>cn_5ltr</code> : number of solo 5’ LTRs found in the genome (minus number of solo 3’ LTRs)</li>
</ul>
</div>
</div>
<div id="detailed-ltrpred-run" class="section level2">
<h2 class="hasAnchor">
<a href="#detailed-ltrpred-run" class="anchor"></a>Detailed LTRpred run</h2>
<p>The <code>Quick Start</code> section aimed at showing you an example <code>LTRpred</code> run and the corresponding output files and file formats. In this section, users will learn about the input data, the available parameters that can be altered and about the diverse set of functions to perform functional annotation of LTR retrotransposons. Please make sure that you have all <a href="https://github.com/HajkD/LTRpred/blob/master/vignettes/Installation.Rmd">prerequisite tools</a> installed on your system.</p>
<p>As an example, we will run LTRpred on the <code>Saccharomyces cerevisiae</code> genome.</p>
<p><strong>Please be aware that functional de novo annotation is a computationally heavy task that requires substantial computing resources. For larger genomes recommend running LTRpred on a computing server or a high performance computing cluster. Large genome computations can take up to days even with tens of computing cores.</strong></p>
<p>The following example, however, will terminate within a few minutes.</p>
<p>First we use the <a href="https://github.com/ropensci/biomartr">biomartr</a> package to download the genome of <code>Saccharomyces cerevisiae</code> from NCBI RefSeq:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># retrieve S. cerevisiae genome from from NCBI RefSeq</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">Scerevisiae_genome &lt;-<span class="st"> </span>biomartr<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/biomartr/reference/getGenome.html">getGenome</a></span>(<span class="dt">db =</span> <span class="st">"refseq"</span>, </a>
<a class="sourceLine" id="cb31-3" data-line-number="3">                      <span class="dt">organism  =</span> <span class="st">"Saccharomyces cerevisiae"</span>)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4"><span class="co"># show path to S. cerevisiae genome</span></a>
<a class="sourceLine" id="cb31-5" data-line-number="5">Scerevisiae_genome</a></code></pre></div>
<p>Next, we run <code>LTRpred</code> to generate functional annotation for <code>S. cerevisiae</code> LTR retrotransposons. In general, the <code><a href="../reference/LTRpred.html">LTRpred()</a></code> function takes the path to a genome file in <code>fasta</code> format (compressed files can be used as well) as input to the <code>genome.file</code> argument. The <code>trnas</code> argument takes a file path to a <code>fasta</code> file storing tRNA sequences. In this case, for example reasons only, we use the tRNA file <code>sacCer3-tRNAs.fa</code> that comes with the <code>LTRpred</code> package. In addition, users can find tRNA files at <a href="http://gtrnadb.ucsc.edu/" class="uri">http://gtrnadb.ucsc.edu/</a> or <a href="http://gtrnadb2009.ucsc.edu/" class="uri">http://gtrnadb2009.ucsc.edu/</a>. The <code>hmms</code> argument takes a path to a folder storing the HMM models of the gag and pol protein domains. Protein domains can be found at <a href="http://pfam.xfam.org/" class="uri">http://pfam.xfam.org/</a> . When renaming the protein domains using the specification <code>hmm_*</code> users can specify <code>hmm_*</code> which indicates that all files in the folder starting with <code>hmm_</code> shall be used. The <code>LTRpred</code> package already stores the most prominent gag and pol protein domains and can be used by specifying the path <code><a href="https://rdrr.io/r/base/paste.html">paste0(system.file("HMMs/", package = "LTRpred"), "hmm_*")</a></code>. In detail, the following HMM models are stored in <code>LTRpred</code>:</p>
<div id="hmm-models" class="section level4">
<h4 class="hasAnchor">
<a href="#hmm-models" class="anchor"></a>HMM Models:</h4>
<p>We retrieved the HMM models for protein domain annotation of the region between de novo predicted LTRs from <a href="http://pfam.xfam.org">Pfam</a>:</p>
<ul>
<li>RNA dependent RNA polymerase: <a href="http://pfam.xfam.org/clan/CL0027">Overview</a>
<ul>
<li><a href="http://pfam.xfam.org/family/PF00680#tabview=tab6">RdRP_1</a></li>
<li><a href="http://pfam.xfam.org/family/PF00978#tabview=tab6">RdRP_2</a></li>
<li><a href="http://pfam.xfam.org/family/PF00998#tabview=tab6">RdRP_3</a></li>
<li><a href="http://pfam.xfam.org/family/PF02123#tabview=tab6">RdRP_4</a></li>
<li><a href="http://pfam.xfam.org/family/PF00078#tabview=tab6">RVT_1</a></li>
<li><a href="http://pfam.xfam.org/family/PF07727#tabview=tab6">RVT_2</a></li>
<li><a href="http://pfam.xfam.org/family/PF00552#tabview=tab6">Integrase DNA binding domain</a></li>
<li><a href="http://pfam.xfam.org/family/PF02022#tabview=tab6">Integrase Zinc binding domain</a></li>
<li><a href="http://pfam.xfam.org/family/PF03732#tabview=tab6">Retrotrans_gag</a></li>
<li><a href="http://pfam.xfam.org/family/PF00075#tabview=tab6">RNase H</a></li>
<li><a href="http://pfam.xfam.org/family/PF00665#tabview=tab6">Integrase core domain</a></li>
<li><a href="http://pfam.xfam.org/family/PF07253#tabview=tab6">Several Gypsy/Env proteins from Drosophila (Gypsy)</a></li>
<li><a href="http://pfam.xfam.org/family/PF00429#tabview=tab6">ENV polyprotein (TLV coat polyprotein)</a></li>
</ul>
</li>
</ul>
<p>The argument <code>cluster = TRUE</code> indicates that individually predicted LTR retrotransposons are clustered by sequence similarity into families using the <code>vsearch</code> program. The <code>clust.sim</code> defines the sequence similarity threshold for considering family/cluster members.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(LTRpred)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co"># de novo LTR transposon prediction of 'D. simulans'</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="kw"><a href="../reference/LTRpred.html">LTRpred</a></span>(</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">    <span class="dt">genome.file =</span> Scerevisiae_genome,</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">    <span class="dt">trnas       =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"tRNAs/"</span>, <span class="dt">package =</span> <span class="st">"LTRpred"</span>),<span class="st">"sacCer3-tRNAs.fa"</span>),</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">    <span class="dt">hmms        =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"HMMs/"</span>, <span class="dt">package =</span> <span class="st">"LTRpred"</span>), <span class="st">"hmm_*"</span>),</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">    <span class="dt">cluster     =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">    <span class="dt">clust.sim   =</span> <span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb32-9" data-line-number="9">    <span class="dt">copy.number.est =</span> <span class="ot">TRUE</span>,  </a>
<a class="sourceLine" id="cb32-10" data-line-number="10">    <span class="dt">cores =</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11">)</a></code></pre></div>
<pre><code>Running LTRpred on genome '_ncbi_downloads/genomes/Saccharomyces_cerevisiae_genomic_refseq.fna.gz' with 4 core(s) and searching for retrotransposons using the overlaps option (overlaps = 'no') ...


The output folder 'Saccharomyces_cerevisiae_genomic_refseq_ltrpred' does not seem to exist yet and will be created ...


LTRpred - Step 1:
Run LTRharvest...
LTRharvest: Generating index file Saccharomyces_cerevisiae_genomic_refseq_ltrharvest/Saccharomyces_cerevisiae_genomic_refseq_index.fsa with gt suffixerator...
Running LTRharvest and writing results to Saccharomyces_cerevisiae_genomic_refseq_ltrharvest...
LTRharvest analysis finished!


LTRpred - Step 2:
Generating index file Saccharomyces_cerevisiae_genomic_refseq_ltrdigest/Saccharomyces_cerevisiae_genomic_refseq_index_ltrdigest.fsa with suffixerator...
LTRdigest: Sort index file...
Running LTRdigest and writing results to Saccharomyces_cerevisiae_genomic_refseq_ltrdigest...
LTRdigest analysis finished!


LTRpred - Step 3:
Import LTRdigest Predictions...

Input:  Saccharomyces_cerevisiae_genomic_refseq_ltrdigest/Saccharomyces_cerevisiae_genomic_refseq_LTRdigestPrediction.gff  -&gt; Row Number:  283
Remove 'NA' -&gt; New Row Number:  283
(1/8) Filtering for repeat regions has been finished.
(2/8) Filtering for LTR retrotransposons has been finished.
(3/8) Filtering for inverted repeats has been finished.
(4/8) Filtering for LTRs has been finished.
(5/8) Filtering for target site duplication has been finished.
(6/8) Filtering for primer binding site has been finished.
(7/8) Filtering for protein match has been finished.
(8/8) Filtering for RR tract has been finished.


LTRpred - Step 4:
Perform ORF Prediction using 'usearch -fastx_findorfs' ...
usearch v8.1.1861_i86osx32, 4.0Gb RAM (17.2Gb total), 8 cores
(C) Copyright 2013-15 Robert C. Edgar, all rights reserved.
http://drive5.com/usearch

00:00 2.2Mb  100.0% Working
Join ORF Prediction table: nrow(df) = 36 candidates.
unique(ID) = 36 candidates.
unique(orf.id) = 36 candidates.
Perform clustering of similar LTR transposons using 'vsearch --cluster_fast' ...
Running CLUSTpred with 90% as sequence similarity threshold using 4 cores ...
Reading file /Users/h-gd/Desktop/Projekte/R Packages/Packages/LTRpred/Saccharomyces_cerevisiae_genomic_refseq_ltrdigest/Saccharomyces_cerevisiae_genomic_refseq-ltrdigest_complete.fas 100%
248182 nt in 36 seqs, min 5189, max 24168, avg 6894
Sorting by length 100%
Counting unique k-mers 100%
Clustering 100%
Sorting clusters 100%
Writing clusters 100%
Clusters: 10 Size min 1, max 19, avg 3.6
Singletons: 7, 19.4% of seqs, 70.0% of clusters
Sorting clusters by abundance 100%
vsearch v1.10.2_osx_x86_64, 16.0GB RAM, 8 cores
https://github.com/torognes/vsearch

CLUSTpred output has been stored in: Saccharomyces_cerevisiae_genomic_refseq_ltrpred
Join Cluster table: nrow(df) = 36 candidates.
unique(ID) = 36 candidates.
unique(orf.id) = 36 candidates.
Join Cluster Copy Number table: nrow(df) = 36 candidates.
unique(ID) = 36 candidates.
unique(orf.id)) = 36 candidates.


LTRpred - Step 5:
Perform methylation context quantification..
Join methylation context (CG, CHG, CHH, CCG) count table: nrow(df) = 36 candidates.
unique(ID) = 36 candidates.
unique(orf.id) = 36 candidates.
Copy files to result folder 'Saccharomyces_cerevisiae_genomic_refseq_ltrpred'.


LTRpred - Step 6:
Starting retrotransposon evolutionary age estimation by comparing the 3' and 5' LTRs using the molecular evolution model 'K80' and the mutation rate '1.3e-07' (please make sure the mutation rate can be assumed for your species of interest!) for 36 predicted elements ...


Please be aware that evolutionary age estimation based on 3' and 5' LTR comparisons are only very rough time estimates and don't take reverse-transcription mediated retrotransposon recombination between family members of retroelements into account! Please consult Sanchez et al., 2017 Nature Communications and Drost &amp; Sanchez, 2019 Genome Biology and Evolution for more details on retrotransposon recombination.


LTRpred - Step 7:
The LTRpred prediction table has been filtered (default) to remove potential false positives. Predicted LTRs must have an PBS or Protein Domain and must fulfill thresholds: sim = 70%; #orfs = 0. Furthermore, TEs having more than 10% of N's in their sequence have also been removed.
Input #TEs: 36
Output #TEs: 31
Perform solo LTR Copy Number Estimation....
Run makeblastdb of the genome assembly...


Building a new DB, current time: 01/24/2020 14:58:55
New DB name:   _ncbi_downloads/genomes/Saccharomyces_cerevisiae_genomic_refseq.fna
New DB title:  _ncbi_downloads/genomes/Saccharomyces_cerevisiae_genomic_refseq.fna
Sequence type: Nucleotide
Keep Linkouts: T
Keep MBits: T
Maximum file size: 1000000000B
Adding sequences from FASTA; added 17 sequences in 0.129384 seconds.
Perform BLAST searches of 3' prime LTRs against genome assembly...
Perform BLAST searches of 5' prime LTRs against genome assembly...
Import BLAST results...
Filter hit results...
Estimate CNV for each LTR sequence...
Finished LTR CNV estimation!


TRpred finished all analyses successfully. All output files were stored at 'Saccharomyces_cerevisiae_genomic_refseq_ltrpred'.
[1] "Successful job 1 ."
Warning message:
The LTR copy number estimation returned an empty file. This suggests that there were no solo LTRs found in the input genome sequence. </code></pre>
<p>The output can then be imported using:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># import LTRpred output for S. cerevisiae</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(<span class="st">"Saccharomyces_cerevisiae_genomic_refseq_ltrpred"</span>,</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">                  <span class="st">"Saccharomyces_cerevisiae_genomic_refseq_LTRpred_DataSheet.tsv"</span>)</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">Scerevisiae_LTRpred &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read.ltrpred.html">read.ltrpred</a></span>(file)</a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="co"># look at output</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6">dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(Scerevisiae_LTRpred)</a></code></pre></div>
<pre><code>Observations: 31
Variables: 92
$ species                 &lt;chr&gt; "Saccharomyces_cerevisiae...
$ ID                      &lt;chr&gt; "Saccharomyces_cerevisiae...
$ dfam_target_name        &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ ltr_similarity          &lt;dbl&gt; 100.00, 97.15, 99.40, 96....
$ ltr_age_mya             &lt;dbl&gt; 0.00000000, 0.05613384, 0...
$ similarity              &lt;chr&gt; "(98,100]", "(96,98]", "(...
$ protein_domain          &lt;chr&gt; "rve/RVT_2", "rve/RVT_2",...
$ orfs                    &lt;int&gt; 2, 2, 2, 2, 2, 3, 2, 2, 2...
$ chromosome              &lt;chr&gt; "NC", "NC", "NC", "NC", "...
$ start                   &lt;int&gt; 160238, 221030, 259578, 2...
$ end                     &lt;int&gt; 166162, 226960, 265494, 2...
$ strand                  &lt;chr&gt; "-", "+", "+", "-", "+", ...
$ width                   &lt;int&gt; 5925, 5931, 5917, 5927, 5...
$ annotation              &lt;chr&gt; "LTR_retrotransposon", "L...
$ pred_tool               &lt;chr&gt; "LTRpred", "LTRpred", "LT...
$ frame                   &lt;chr&gt; ".", ".", ".", ".", ".", ...
$ score                   &lt;chr&gt; ".", ".", ".", ".", ".", ...
$ lLTR_start              &lt;int&gt; 160238, 221030, 259578, 2...
$ lLTR_end                &lt;int&gt; 160574, 221380, 259909, 2...
$ lLTR_length             &lt;int&gt; 337, 351, 332, 350, 380, ...
$ rLTR_start              &lt;int&gt; 165826, 226615, 265163, 2...
$ rLTR_end                &lt;int&gt; 166162, 226960, 265494, 2...
$ rLTR_length             &lt;int&gt; 337, 346, 332, 339, 369, ...
$ lTSD_start              &lt;int&gt; 160233, 221026, 259573, 2...
$ lTSD_end                &lt;int&gt; 160237, 221029, 259577, 2...
$ lTSD_motif              &lt;chr&gt; "gaacc", "aaca", "gtaat",...
$ rTSD_start              &lt;int&gt; 166163, 226961, 265495, 2...
$ rTSD_end                &lt;int&gt; 166167, 226964, 265499, 2...
$ rTSD_motif              &lt;chr&gt; "gaacc", "aaca", "gtaat",...
$ PPT_start               &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_end                 &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_motif               &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_strand              &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_offset              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_start               &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_end                 &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_strand              &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ tRNA                    &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ tRNA_motif              &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_offset              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ tRNA_offset             &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ `PBS/tRNA_edist`        &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ orf.id                  &lt;chr&gt; "NC_001133.9_Saccharo_160...
$ repeat_region_length    &lt;int&gt; 5935, 5939, 5927, 5935, 5...
$ PPT_length              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_length              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_acc                &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_bits               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_e_value            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_bias               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_hmm-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_hmm-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_strand             &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_ali-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_ali-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_env-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_env-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_modlen             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_target_description &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ Clust_Cluster           &lt;chr&gt; "cl_4", "cl_4", "cl_4", "...
$ Clust_Target            &lt;chr&gt; "NC_001140.6_Saccharo_543...
$ Clust_Perc_Ident        &lt;dbl&gt; 94.1, 92.4, 95.9, 96.6, 9...
$ Clust_cn                &lt;int&gt; 19, 19, 19, 19, 19, 19, 7...
$ TE_CG_abs               &lt;dbl&gt; 160, 157, 168, 167, 156, ...
$ TE_CG_rel               &lt;dbl&gt; 0.02700422, 0.02647108, 0...
$ TE_CHG_abs              &lt;dbl&gt; 187, 192, 197, 199, 193, ...
$ TE_CHG_rel              &lt;dbl&gt; 0.03156118, 0.03237228, 0...
$ TE_CHH_abs              &lt;dbl&gt; 922, 919, 901, 914, 936, ...
$ TE_CHH_rel              &lt;dbl&gt; 0.1556118, 0.1549486, 0.1...
$ TE_CCG_abs              &lt;dbl&gt; 33, 38, 38, 36, 34, 35, 2...
$ TE_CCG_rel              &lt;dbl&gt; 0.005569620, 0.006407014,...
$ TE_N_abs                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CG_3ltr_abs             &lt;dbl&gt; 6, 5, 6, 7, 3, 6, 5, 5, 6...
$ CG_3ltr_rel             &lt;dbl&gt; 0.017804154, 0.014450867,...
$ CHG_3ltr_abs            &lt;dbl&gt; 2, 4, 3, 3, 3, 4, 2, 2, 3...
$ CHG_3ltr_rel            &lt;dbl&gt; 0.005934718, 0.011560694,...
$ CHH_3ltr_abs            &lt;dbl&gt; 41, 40, 36, 37, 45, 40, 4...
$ CHH_3ltr_rel            &lt;dbl&gt; 0.1216617, 0.1156069, 0.1...
$ CCG_3ltr_abs            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CCG_3ltr_rel            &lt;dbl&gt; 0.000000000, 0.000000000,...
$ N_3ltr_abs              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CG_5ltr_abs             &lt;dbl&gt; 6, 5, 6, 7, 3, 6, 5, 5, 6...
$ CG_5ltr_rel             &lt;dbl&gt; 0.017804154, 0.014450867,...
$ CHG_5ltr_abs            &lt;dbl&gt; 2, 4, 3, 3, 3, 4, 2, 2, 3...
$ CHG_5ltr_rel            &lt;dbl&gt; 0.005934718, 0.011560694,...
$ CHH_5ltr_abs            &lt;dbl&gt; 41, 40, 36, 37, 45, 40, 4...
$ CHH_5ltr_rel            &lt;dbl&gt; 0.1216617, 0.1156069, 0.1...
$ CCG_5ltr_abs            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CCG_5ltr_rel            &lt;dbl&gt; 0.000000000, 0.000000000,...
$ N_5ltr_abs              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ cn_3ltr                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ cn_5ltr                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...</code></pre>
<p>Now, users can filter for potentially functional LTR retrotransposons using the <code><a href="../reference/quality.filter.html">quality.filter()</a></code> function. The argument <code>sim</code> specifies the miminum sequence similarity between the LTRs of the predicted retrotransposons. E.g., when <code>sim = 97</code> all retrotransposons having less than 97% sequence similarity between their LTRs are removed. Argument <code>n.orfs</code> specifies the minimum number of open reading frames (ORFs) that were predicted to exist in the predicted retrotransposon. E.g., when <code>n.orfs = 1</code> all retrotransposon having zero ORFs are removed. The argument <code>strategy</code> refers to the filter strategy that shall be applied. Options are:</p>
<ul>
<li>
<code>strategy = "default"</code> :
<ul>
<li>
<code>ltr.similarity</code>: Minimum similarity between LTRs. All TEs not matching this criteria are discarded.</li>
<li>
<code>n.orfs</code>: minimum number of ORFs that must be found between the LTRs. All TEs not matching this criteria are discarded.</li>
<li>
<code>PBS</code> or Protein Match: elements must either have a predicted Primer Binding Site or a protein match of at least one protein (Gag, Pol, Rve, …) between their LTRs. All TEs not matching this criteria are discarded.</li>
<li>The relative number of N’s (= nucleotide not known) in TE &lt;= 0.1. The relative number of N’s is computed as follows: absolute number of N’s in TE / width of TE.</li>
</ul>
</li>
<li>
<code>strategy = "stringent"</code> : in addition to filter criteria specified in section Quality Control, the filter criteria !is.na(protein_domain)) | (dfam_target_name != “unknown”) is applied</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># filter for potentially functional LTR retrotransposons</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2">Scerevisiae_functional &lt;-<span class="st"> </span><span class="kw"><a href="../reference/quality.filter.html">quality.filter</a></span>(Scerevisiae_LTRpred, </a>
<a class="sourceLine" id="cb36-3" data-line-number="3">                                         <span class="dt">sim =</span> <span class="dv">97</span>, </a>
<a class="sourceLine" id="cb36-4" data-line-number="4">                                         <span class="dt">n.orfs =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">                                         <span class="dt">strategy =</span> <span class="st">"stringent"</span>)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(Scerevisiae_functional)</a></code></pre></div>
<pre><code>Observations: 25
Variables: 92
$ species                 &lt;chr&gt; "Saccharomyces_cerevisiae...
$ ID                      &lt;chr&gt; "Saccharomyces_cerevisiae...
$ dfam_target_name        &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ ltr_similarity          &lt;dbl&gt; 100.00, 97.15, 99.40, 100...
$ ltr_age_mya             &lt;dbl&gt; 0.00000000, 0.05613384, 0...
$ similarity              &lt;chr&gt; "(98,100]", "(96,98]", "(...
$ protein_domain          &lt;chr&gt; "rve/RVT_2", "rve/RVT_2",...
$ orfs                    &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2...
$ chromosome              &lt;chr&gt; "NC", "NC", "NC", "NC", "...
$ start                   &lt;int&gt; 160238, 221030, 259578, 9...
$ end                     &lt;int&gt; 166162, 226960, 265494, 9...
$ strand                  &lt;chr&gt; "-", "+", "+", "+", "-", ...
$ width                   &lt;int&gt; 5925, 5931, 5917, 5959, 5...
$ annotation              &lt;chr&gt; "LTR_retrotransposon", "L...
$ pred_tool               &lt;chr&gt; "LTRpred", "LTRpred", "LT...
$ frame                   &lt;chr&gt; ".", ".", ".", ".", ".", ...
$ score                   &lt;chr&gt; ".", ".", ".", ".", ".", ...
$ lLTR_start              &lt;int&gt; 160238, 221030, 259578, 9...
$ lLTR_end                &lt;int&gt; 160574, 221380, 259909, 9...
$ lLTR_length             &lt;int&gt; 337, 351, 332, 332, 332, ...
$ rLTR_start              &lt;int&gt; 165826, 226615, 265163, 9...
$ rLTR_end                &lt;int&gt; 166162, 226960, 265494, 9...
$ rLTR_length             &lt;int&gt; 337, 346, 332, 332, 332, ...
$ lTSD_start              &lt;int&gt; 160233, 221026, 259573, 9...
$ lTSD_end                &lt;int&gt; 160237, 221029, 259577, 9...
$ lTSD_motif              &lt;chr&gt; "gaacc", "aaca", "gtaat",...
$ rTSD_start              &lt;int&gt; 166163, 226961, 265495, 9...
$ rTSD_end                &lt;int&gt; 166167, 226964, 265499, 9...
$ rTSD_motif              &lt;chr&gt; "gaacc", "aaca", "gtaat",...
$ PPT_start               &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_end                 &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_motif               &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_strand              &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ PPT_offset              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_start               &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_end                 &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_strand              &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ tRNA                    &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ tRNA_motif              &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_offset              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ tRNA_offset             &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ `PBS/tRNA_edist`        &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ orf.id                  &lt;chr&gt; "NC_001133.9_Saccharo_160...
$ repeat_region_length    &lt;int&gt; 5935, 5939, 5927, 5969, 5...
$ PPT_length              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ PBS_length              &lt;int&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_acc                &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_bits               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_e_value            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_bias               &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_hmm-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_hmm-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_strand             &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_ali-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_ali-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_env-st`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ `dfam_env-en`           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_modlen             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ dfam_target_description &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...
$ Clust_Cluster           &lt;chr&gt; "cl_4", "cl_4", "cl_4", "...
$ Clust_Target            &lt;chr&gt; "NC_001140.6_Saccharo_543...
$ Clust_Perc_Ident        &lt;dbl&gt; 94.1, 92.4, 95.9, 98.8, 9...
$ Clust_cn                &lt;int&gt; 19, 19, 19, 7, 19, 19, 19...
$ TE_CG_abs               &lt;dbl&gt; 160, 157, 168, 152, 159, ...
$ TE_CG_rel               &lt;dbl&gt; 0.02700422, 0.02647108, 0...
$ TE_CHG_abs              &lt;dbl&gt; 187, 192, 197, 155, 189, ...
$ TE_CHG_rel              &lt;dbl&gt; 0.03156118, 0.03237228, 0...
$ TE_CHH_abs              &lt;dbl&gt; 922, 919, 901, 912, 922, ...
$ TE_CHH_rel              &lt;dbl&gt; 0.1556118, 0.1549486, 0.1...
$ TE_CCG_abs              &lt;dbl&gt; 33, 38, 38, 26, 34, 32, 3...
$ TE_CCG_rel              &lt;dbl&gt; 0.005569620, 0.006407014,...
$ TE_N_abs                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CG_3ltr_abs             &lt;dbl&gt; 6, 5, 6, 5, 6, 6, 6, 4, 6...
$ CG_3ltr_rel             &lt;dbl&gt; 0.017804154, 0.014450867,...
$ CHG_3ltr_abs            &lt;dbl&gt; 2, 4, 3, 2, 3, 3, 3, 2, 2...
$ CHG_3ltr_rel            &lt;dbl&gt; 0.005934718, 0.011560694,...
$ CHH_3ltr_abs            &lt;dbl&gt; 41, 40, 36, 40, 38, 40, 3...
$ CHH_3ltr_rel            &lt;dbl&gt; 0.12166172, 0.11560694, 0...
$ CCG_3ltr_abs            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CCG_3ltr_rel            &lt;dbl&gt; 0.000000000, 0.000000000,...
$ N_3ltr_abs              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CG_5ltr_abs             &lt;dbl&gt; 6, 5, 6, 5, 6, 6, 6, 4, 6...
$ CG_5ltr_rel             &lt;dbl&gt; 0.017804154, 0.014450867,...
$ CHG_5ltr_abs            &lt;dbl&gt; 2, 4, 3, 2, 3, 3, 3, 2, 2...
$ CHG_5ltr_rel            &lt;dbl&gt; 0.005934718, 0.011560694,...
$ CHH_5ltr_abs            &lt;dbl&gt; 41, 40, 36, 40, 38, 40, 3...
$ CHH_5ltr_rel            &lt;dbl&gt; 0.12166172, 0.11560694, 0...
$ CCG_5ltr_abs            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ CCG_5ltr_rel            &lt;dbl&gt; 0.000000000, 0.000000000,...
$ N_5ltr_abs              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0...
$ cn_3ltr                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...
$ cn_5ltr                 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, N...</code></pre>
<p>The functional annotation table can then be transformed and saved in different data formats using the <code>pred2*()</code> functions. Options are:</p>
<ul>
<li>
<code><a href="../reference/pred2bed.html">pred2bed()</a></code>: Format LTR prediction data to BED file format</li>
<li>
<code><a href="../reference/pred2csv.html">pred2csv()</a></code>: Format LTR prediction data to CSV file format</li>
<li>
<code><a href="../reference/pred2fasta.html">pred2fasta()</a></code>: Save the sequence of the predicted LTR Transposons in a fasta file</li>
<li>
<code><a href="../reference/pred2gff.html">pred2gff()</a></code>: Format LTR prediction data to GFF3 file format</li>
<li>
<code><a href="../reference/pred2tsv.html">pred2tsv()</a></code>: Format LTR prediction data to TSV file format</li>
</ul>
<p>In this example we will store the functional annotation results <code>Scerevisiae_functional</code> as <code>gff</code> file.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw"><a href="../reference/pred2gff.html">pred2gff</a></span>(<span class="dt">LTR.data =</span> Scerevisiae_functional,</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">         <span class="dt">output   =</span> <span class="st">"Scerevisiae_functional_LTRpred.gff"</span>,</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">         <span class="dt">program  =</span> <span class="st">"LTRpred"</span>)</a></code></pre></div>
<p>This gff file can now be used for mapping tools, genome browsers, etc.</p>
</div>
<div id="detailed-description-of-adjustable-ltrpred-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#detailed-description-of-adjustable-ltrpred-parameters" class="anchor"></a>Detailed description of adjustable LTRpred parameters</h3>
<p>The <code>S. cerevisiae</code> example shown above assumes that users wish to run <code>LTRpred</code> using a default parameter configuration. However, as the figure shown below demonstrates, there are large number of parameters that can be adjusted and altered according the the user’s specifications and interests.</p>
<p>Users can adjust and run <code>LTRpred</code> with the following parameter options:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw"><a href="../reference/LTRpred.html">LTRpred</a></span>(</a>
<a class="sourceLine" id="cb39-2" data-line-number="2">  <span class="dt">genome.file =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-3" data-line-number="3">  <span class="dt">model =</span> <span class="st">"K80"</span>,</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">  <span class="dt">mutation_rate =</span> <span class="fl">1.3</span> <span class="op">*</span><span class="st"> </span><span class="fl">1e-07</span>,</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">  <span class="dt">index.file.harvest =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-6" data-line-number="6">  <span class="dt">index.file.digest =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-7" data-line-number="7">  <span class="dt">LTRdigest.gff =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-8" data-line-number="8">  <span class="dt">tabout.file =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-9" data-line-number="9">  <span class="dt">LTRharvest.folder =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-10" data-line-number="10">  <span class="dt">LTRpred.folder =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-11" data-line-number="11">  <span class="dt">orf.file =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-12" data-line-number="12">  <span class="dt">annotate =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-13" data-line-number="13">  <span class="dt">Dfam.db =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-14" data-line-number="14">  <span class="dt">dfam.eval =</span> <span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb39-15" data-line-number="15">  <span class="dt">dfam.file =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-16" data-line-number="16">  <span class="dt">cluster =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb39-17" data-line-number="17">  <span class="dt">clust.sim =</span> <span class="fl">0.9</span>,</a>
<a class="sourceLine" id="cb39-18" data-line-number="18">  <span class="dt">clust.file =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-19" data-line-number="19">  <span class="dt">copy.number.est =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb39-20" data-line-number="20">  <span class="dt">fix.chr.name =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb39-21" data-line-number="21">  <span class="dt">cn.eval =</span> <span class="fl">1e-10</span>,</a>
<a class="sourceLine" id="cb39-22" data-line-number="22">  <span class="dt">range =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb39-23" data-line-number="23">  <span class="dt">seed =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb39-24" data-line-number="24">  <span class="dt">minlenltr =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb39-25" data-line-number="25">  <span class="dt">maxlenltr =</span> <span class="dv">3500</span>,</a>
<a class="sourceLine" id="cb39-26" data-line-number="26">  <span class="dt">mindistltr =</span> <span class="dv">4000</span>,</a>
<a class="sourceLine" id="cb39-27" data-line-number="27">  <span class="dt">maxdistltr =</span> <span class="dv">25000</span>,</a>
<a class="sourceLine" id="cb39-28" data-line-number="28">  <span class="dt">similar =</span> <span class="dv">70</span>,</a>
<a class="sourceLine" id="cb39-29" data-line-number="29">  <span class="dt">mintsd =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb39-30" data-line-number="30">  <span class="dt">maxtsd =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb39-31" data-line-number="31">  <span class="dt">vic =</span> <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb39-32" data-line-number="32">  <span class="dt">overlaps =</span> <span class="st">"no"</span>,</a>
<a class="sourceLine" id="cb39-33" data-line-number="33">  <span class="dt">xdrop =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb39-34" data-line-number="34">  <span class="dt">mat =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb39-35" data-line-number="35">  <span class="dt">mis =</span> <span class="dv">-2</span>,</a>
<a class="sourceLine" id="cb39-36" data-line-number="36">  <span class="dt">ins =</span> <span class="dv">-3</span>,</a>
<a class="sourceLine" id="cb39-37" data-line-number="37">  <span class="dt">del =</span> <span class="dv">-3</span>,</a>
<a class="sourceLine" id="cb39-38" data-line-number="38">  <span class="dt">motif =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-39" data-line-number="39">  <span class="dt">motifmis =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb39-40" data-line-number="40">  <span class="dt">aaout =</span> <span class="st">"yes"</span>,</a>
<a class="sourceLine" id="cb39-41" data-line-number="41">  <span class="dt">aliout =</span> <span class="st">"yes"</span>,</a>
<a class="sourceLine" id="cb39-42" data-line-number="42">  <span class="dt">pptlen =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">8</span>, <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb39-43" data-line-number="43">  <span class="dt">uboxlen =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>, <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb39-44" data-line-number="44">  <span class="dt">pptradius =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb39-45" data-line-number="45">  <span class="dt">trnas =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-46" data-line-number="46">  <span class="dt">pbsalilen =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">11</span>, <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb39-47" data-line-number="47">  <span class="dt">pbsoffset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb39-48" data-line-number="48">  <span class="dt">pbstrnaoffset =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb39-49" data-line-number="49">  <span class="dt">pbsmaxedist =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb39-50" data-line-number="50">  <span class="dt">pbsradius =</span> <span class="dv">30</span>,</a>
<a class="sourceLine" id="cb39-51" data-line-number="51">  <span class="dt">hmms =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-52" data-line-number="52">  <span class="dt">pdomevalcutoff =</span> <span class="fl">1e-05</span>,</a>
<a class="sourceLine" id="cb39-53" data-line-number="53">  <span class="dt">pbsmatchscore =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb39-54" data-line-number="54">  <span class="dt">pbsmismatchscore =</span> <span class="dv">-10</span>,</a>
<a class="sourceLine" id="cb39-55" data-line-number="55">  <span class="dt">pbsinsertionscore =</span> <span class="dv">-20</span>,</a>
<a class="sourceLine" id="cb39-56" data-line-number="56">  <span class="dt">pbsdeletionscore =</span> <span class="dv">-20</span>,</a>
<a class="sourceLine" id="cb39-57" data-line-number="57">  <span class="dt">pfam.ids =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-58" data-line-number="58">  <span class="dt">cores =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb39-59" data-line-number="59">  <span class="dt">dfam.cores =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-60" data-line-number="60">  <span class="dt">hmm.cores =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-61" data-line-number="61">  <span class="dt">orf.style =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb39-62" data-line-number="62">  <span class="dt">min.codons =</span> <span class="dv">200</span>,</a>
<a class="sourceLine" id="cb39-63" data-line-number="63">  <span class="dt">trans.seqs =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb39-64" data-line-number="64">  <span class="dt">output.path =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb39-65" data-line-number="65">  <span class="dt">quality.filter =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb39-66" data-line-number="66">  <span class="dt">n.orfs =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb39-67" data-line-number="67">  <span class="dt">verbose =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb39-68" data-line-number="68">)</a></code></pre></div>
<ul>
<li>
<code>genome.file</code>: path to the genome assembly file in fasta format.</li>
<li>
<code>model</code>: a molecular evolution model to estimate the insertion age of the predicted retrotransposon</li>
<li>
<code>mutation_rate</code>: mutation rate applied to the organism of interest when applying the molecular evolution model to estimate the insertion age of the predicted retrotransposon</li>
<li>
<code>index.file.harvest</code>: in case users have already computed index files they can specify the name of the enhanced suffix array index file that was computed by <code>suffixerator</code> for the use of <code>LTRharvest</code>. This option can be used in case the suffix file was previously generated, e.g. during a previous call of this function. In this case the suffix array index file does not need to be re-computed for new analyses. This is particularly useful when running <code>LTRpred</code> with different parameter settings.</li>
<li>
<code>index.file.digest</code>: specify the name of the enhanced suffix array index file that is computed by <code>suffixerator</code> for the use of <code>LTRdigest</code>. This option can be used in case the suffix file was previously generated, e.g. during a previous call of this function. In this case the suffix array index file does not need to be re-computed for new analyses. This is particularly useful when running <code>LTRpred</code> with different parameter settings.</li>
<li>
<code>LTRdigest.gff</code>: path to the LTRdigest generated GFF file <code>*_LTRdigestPrediction.gff</code>, in case <code>LTRdigest</code> files were computed previously.</li>
<li>
<code>tabout.file</code>: path to the LTRdigest generated tabout file file <code>*-ltrdigest_tabout.csv</code>, in case <code>LTRdigest</code> files were computed previously.</li>
<li>
<code>LTRharvest.folder</code>: either <code>LTRharvest.folder = NULL</code> (default) or <code>LTRharvest.folder = "skip"</code> to skip a LTRharvest folder if it is not present.</li>
<li>
<code>LTRpred.folder</code>: name/path of/to an existing LTRpred folder. All pre-computed files in this folder will then be used and only steps of the <code>LTRpred</code> pipeline that haven’t been computed yet will be run.</li>
<li>
<code>orf.file</code>: path to the file generated by <code>ORFpred</code>, in case the orf prediction file was generated previously. See <code><a href="../reference/ORFpred.html">?ORFpred</a></code> for details.</li>
<li>
<code>annotate</code>: annotation database that shall be queried to annotate predicted LTR transposons. Default is <code>annotate = NULL</code> indicating that no annotation query is performed. Possible options are:
<ul>
<li>
<code>annotate = "Dfam"</code> (here the Dfam database must be stored locally and a <code>nhammer</code> search is performed against the Dfam database)</li>
</ul>
</li>
<li>
<code>Dfam.db</code>: folder path to the local Dfam database or <code>Dfam.db = "download"</code> in case the <code>Dfam</code> database shall be automatically downloaded before performing query analyses.</li>
<li>
<code>dfam.eval</code>: E-value threshhold to perform HMMer search against the Dfam database.</li>
<li>
<code>dfam.file</code>: path to pre-computed <code>dfam.query</code> output file. Can only be used in combination with <code>annotate = "Dfam"</code>. Please consult <code><a href="../reference/dfam.query.html">?dfam.query</a></code> for details.</li>
<li>
<code>cluster</code>: shall predicted transposons be clustered with <code>CLUSTpred</code> to determine retrotransposon family relationships?</li>
<li>
<code>clust.sim</code>: cluster reject if sequence similarity is lower than this threshold when performing clustering with <code>CLUSTpred</code>. In other words, what is the minimum sequence similarity between family members. Default is <code>clust.sim = 0.9</code> (= 90%).</li>
<li>
<code>clust.file</code>: file path to pre-computed clustering file generated by <code>CLUSTpred</code> in case clustering has been done before. See <code><a href="../reference/CLUSTpred.html">?CLUSTpred</a></code> for details.</li>
<li>
<code>copy.number.est</code>: shall copy number estimation of 3’ and 5’ LTRs in the genome be performed? In case <code>copy.number.est = TRUE</code> for each 3’ and 5’ LTR of a predicted LTR retrotransposon a stringent BLAST search is performed against the genome to determine the number of copies (solo LTR copies) of that element within the genome. Default is <code>copy.number.est = FALSE</code>.</li>
<li>
<code>fix.chr.name</code>: sometimes chromosome names have unwanted characters such as "_" etc in them. Shall <code>LTRpred</code> try to fix chromosome names as good as possible?</li>
<li>
<code>cn.eval</code>: BLAST evalue for copy number estimation (<code>copy.number.est</code>) (BLAST hit threshold). Default is <code>cn.eval = 1e-5</code>.</li>
<li>
<code>range</code>: define the genomic interval within the genome assembly in which predicted LTR transposons shall be detected. In case <code>range[1] = 1000</code> and <code>range[2] = 10000</code> then candidates are only reported if they start after 1000 numcleotides in the genome assembly and end before position 10000 in their respective sequence coordinates. If <code>range[1] = 0</code> and <code>range[2] = 0</code>, so <code>range = c(0,0)</code> (default) then the entire genome is being scanned.</li>
<li>
<code>seed</code>: the minimum length for the exact maximal repeats. Only repeats with the specified minimum length are considered in all subsequent analyses. Default is <code>seed = 30</code>.</li>
<li>
<code>minlenltr</code>: minimum LTR length. Default is <code>minlenltr = 100</code>.</li>
<li>
<code>maxlenltr</code>: maximum LTR length. Default is <code>maxlenltr = 3500</code>.</li>
<li>
<code>mindistltr</code>: minimum distance of LTR starting positions. Default is <code>mindistltr = 4000</code>.</li>
<li>
<code>maxdistltr</code>: maximum distance of LTR starting positions. Default is <code>maxdistltr = 25000</code>.</li>
<li>
<code>similar</code>: minimum similarity value between the two LTRs in percent. Default is <code>similar = 70</code>.</li>
<li>
<code>mintsd</code>: minimum target site duplications (TSDs) length. If no search for TSDs shall be performed, then specify mintsd = NULL. Default is <code>mintsd = 4</code>.</li>
<li>
<code>maxtsd</code>: maximum target site duplications (TSDs) length. If no search for TSDs shall be performed, then specify maxtsd = NULL. Default is <code>maxtsd = 20</code>.</li>
<li>
<code>vic</code>: number of nucleotide positions left and right (the vicinity) of the predicted boundary of a LTR that will be searched for TSDs and/or one motif (if specified). Default is <code>vic = 60</code>.</li>
<li>
<code>overlaps</code>: specify how overlapping LTR retrotransposon predictions shall be treated. If overlaps = “no” is selected, then neither nested nor overlapping predictions will be reported in the output. In case <code>overlaps = "best"</code> is selected then in the case of two or more nested or overlapping predictions, solely the LTR retrotransposon prediction with the highest similarity between its LTRs will be reported. If <code>overlaps = "all"</code> is selected then all LTR retrotransposon predictions will be reported whether there are nested and/or overlapping predictions or not. Default is <code>overlaps = "best"</code>.</li>
<li>
<code>xdrop</code>: specify the xdrop value (&gt; 0) for extending a seed repeat in both directions allowing for matches, mismatches, insertions, and deletions. The xdrop extension process stops as soon as the extension involving matches, mismatches, insersions, and deletions has a score smaller than T - X, where T denotes the largest score seen so far. Default is <code>xrop = 5</code>.</li>
<li>
<code>mat</code>: specify the positive match score for the X-drop extension process. Default is <code>mat = 2</code>.</li>
<li>
<code>mis</code>: specify the negative mismatch score for the X-drop extension process. Default is <code>mis = -2</code>.</li>
<li>
<code>ins</code>: specify the negative insertion score for the X-drop extension process. Default is <code>ins = -3</code>.</li>
<li>
<code>del</code>: specify the negative deletion score for the X-drop extension process. Default is <code>del = -3</code>.</li>
<li>
<code>motif</code>: specify 2 nucleotides for the starting motif and 2 nucleotides for the ending motif at the beginning and the ending of each LTR, respectively. Only palindromic motif sequences - where the motif sequence is equal to its complementary sequence read backwards - are allowed, e.g. <code>motif = "tgca"</code>. Type the nucleotides without any space separating them. If this option is not selected by the user, candidate pairs will not be screened for potential motifs. If this options is set but no allowed number of mismatches is specified by the argument motifmis and a search for the exact motif will be conducted. If <code>motif = NULL</code> then no explicit motif is being specified.</li>
<li>
<code>motifmis</code>: allowed number of mismatches in the TSD motif specified in motif. The number of mismatches needs to be between [0,3]. Default is <code>motifmis = 0</code>.</li>
<li>
<code>aaout</code>: shall the protein sequence of the HMM matches to the predicted LTR transposon be generated as fasta file or not. Options are <code>aaout = "yes"</code> or <code>aaout = "no"</code>.</li>
<li>
<code>aliout</code>: shall the alignment of the protein sequence of the HMM matches to the predicted LTR transposon be generated as fasta file or not. Options are <code>aaout = "yes"</code> or <code>aaout = "no"</code>.</li>
<li>
<code>pptlen</code>: a two dimensional numeric vector specifying the minimum and maximum allowed lengths for PPT predictions. If a purine-rich region that does not fulfill this range is found, it will be discarded. Default is <code>pptlen = c(8,30)</code> (minimum = 8; maximum = 30).</li>
<li>
<code>uboxlen</code>: a two dimensional numeric vector specifying the minimum and maximum allowed lengths for U-box predictions. If a T-rich region preceding a PPT that does not fulfill the PPT length criteria is found, it will be discarded. Default is <code>uboxlen = c(3,30)</code> (minimum = 3; maximum = 30).</li>
<li>
<code>pptradius</code>: a numeric value specifying the area around the 3’ LTR beginning to be considered when searching for PPT. Default value is <code>pptradius = 30</code>.</li>
<li>
<code>trnas</code>: path to the fasta file storing the unique tRNA sequences that shall be matched to the predicted LTR transposon (tRNA library).</li>
<li>
<code>pbsalilen</code>: a two dimensional numeric vector specifying the minimum and maximum allowed lengths for PBS/tRNA alignments. If the local alignments are shorter or longer than this range, it will be discarded. Default is <code>pbsalilen = c(11,30)</code> (minimum = 11; maximum = 30).</li>
<li>
<code>pbsoffset</code>: a two dimensional numeric vector specifying the minimum and maximum allowed distance between the start of the PBS and the 3’ end of the 5’ LTR. Local alignments not fulfilling this criteria will be discarded. Default is <code>pbsoffset = c(0,5)</code> (minimum = 0; maximum = 5).</li>
<li>
<code>pbstrnaoffset</code>: a two dimensional numeric vector specifying the minimum and maximum allowed PBS/tRNA alignment offset from the 3’ end of the tRNA. Local alignments not fulfilling this criteria will be discarded. <code>Default is pbstrnaoffset = c(0,5)</code> (minimum = 0; maximum = 5).</li>
<li>
<code>pbsmaxedist</code>: a numeric value specifying the maximal allowed unit edit distance in a local PBS/tRNA alignment.</li>
<li>
<code>pbsradius</code>: a numeric value specifying the area around the 5’ LTR end to be considered when searching for PBS Default value is <code>pbsradius = 30</code>.</li>
<li>
<code>hmms</code>: a character string or a character vector storing either the hmm files for searching internal domains between the LTRs of predicted LTR transposons or a vector of Pfam IDs from <a href="http://pfam.xfam.org/" class="uri">http://pfam.xfam.org/</a> that are downloaded and used to search for corresponding protein domains within the predicted LTR transposons. As an option users can rename all of their hmm files so that they start for example with the name <code>hmms = "hmm_*"</code>. This way all files starting with <code>hmm_</code> will be considered for the subsequent protein domain search. In case Pfam IDs are specified, the LTRpred function will automatically download the corresponding HMM files and use them for further protein domain searches. In case users prefer to specify Pfam IDs please specify them in the <code>pfam.ids</code> parmeter and choose <code>hmms = NULL</code>.</li>
<li>
<code>pdomevalcutoff</code>: a numeric value specifying the E-value cutoff for corresponding HMMER searches. All hits that do not fulfill this criteria are discarded. Default is <code>pdomevalcutoff = 1E-5</code>.</li>
<li>
<code>pbsmatchscore</code>: specify the match score used in the PBS/tRNA Smith-Waterman alignment. Default is <code>pbsmatchscore = 5</code>.</li>
<li>
<code>pbsmismatchscore</code>: specify the mismatch score used in the PBS/tRNA Smith-Waterman alignment. Default is <code>pbsmismatchscore = -10</code>.</li>
<li>
<code>pbsinsertionscore</code>:<br>
specify the insertion score used in the PBS/tRNA Smith-Waterman alignment. Default is <code>pbsinsertionscore = -20</code>.</li>
<li>
<code>pbsdeletionscore</code>: specify the deletion score used in the PBS/tRNA Smith-Waterman alignment. Default is <code>pbsdeletionscore = -20</code>.</li>
<li>
<code>pfam.ids</code>: a character vector storing the Pfam IDs from <a href="http://pfam.xfam.org/" class="uri">http://pfam.xfam.org/</a> that shall be downloaded and used to perform protein domain searches within the sequences between the predicted LTRs.</li>
<li>
<code>cores</code>: the number of cores that shall be used for multicore processing. In case <code>dfam.cores</code> and <code>hmm.cores</code> are not specified then the value of <code>core</code> is used for those arguments.<br>
</li>
<li>
<code>dfam.cores</code>: number of cores to be used for multicore processing when running Dfam query (in case <code>annotate = "Dfam"</code>).</li>
<li>
<code>hmm.cores</code>: number of cores to be used for multicore processing when performing hmmer protein search with <code>LTRdigest</code>.</li>
<li>
<code>orf.style</code>: type of predicting open reading frames (see documentation of USEARCH).</li>
<li>
<code>min.codons</code>: minimum number of codons in the predicted open reading frame.</li>
<li>
<code>trans.seqs</code>: logical value indicating wheter or not predicted open reading frames shall be translated and the corresponding protein sequences stored in the output folder.</li>
<li>
<code>output.path</code>: a path/folder to store all results returned by LTRharvest, LTRdigest, and LTRpred. If <code>output.path = NULL (Default)</code> then a folder with the name of the input genome file will be generated in the current working directory of R and all results are then stored in this folder.</li>
<li>
<code>quality.filter</code>: shall false positives be filtered out as much as possible? Default is <code>quality.filter = TRUE</code>. See Description for details.</li>
<li>
<code>n.orfs</code>: minimum number of Open Reading Frames that must be found between the LTRs (if <code>quality.filter = TRUE</code>). See Details for further information on quality control.</li>
<li>
<code>verbose</code>: shall further information be printed on the console or not.</li>
</ul>
</div>
</div>
<div id="metagenome-scale-annotations" class="section level2">
<h2 class="hasAnchor">
<a href="#metagenome-scale-annotations" class="anchor"></a>Metagenome scale annotations</h2>
<p><code>LTRpred</code> allows users to perform annotations not only for single genomes but for multiple genomes (metagenomes) using only one pipeline function named <code><a href="../reference/LTRpred.meta.html">LTRpred.meta()</a></code>.</p>
<p><strong>Please be aware that <code>LTRpred</code> annotations for multiple genomes is a computationally hard task and requires large server or high performance computer access. Computations for hundreds of genomes even using tens to hundreds of cores might take several weeks to terminate. Please make sure that you have the right computational infrastructure to run these processes.</strong></p>
<p>Users can download the <a href="https://docs.ropensci.org/biomartr/">biomartr</a> package to automatically retrieve genome assembly files for the species of interest.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># specify the scientific names of the species of interest</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="co"># that shall first be downloaded and then be used</span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="co"># to generate LTRpred annotations</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4">species &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Arabidopsis thaliana"</span>, <span class="st">"Arabidopsis lyrata"</span>, <span class="st">"Capsella rubella"</span>) </a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="co"># download the genome assembly files for the species of interest</span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="co"># </span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co"># install.packages("biomartr")</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8">biomartr<span class="op">::</span><span class="kw"><a href="https://docs.ropensci.org/biomartr/reference/getGenomeSet.html">getGenomeSet</a></span>(<span class="dt">db =</span> <span class="st">"refseq"</span>, <span class="dt">organisms =</span> species, <span class="dt">path =</span> <span class="st">"store_genome_set"</span>)</a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="co"># run LTRpred.meta() on the 3 species with 3 cores</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10">LTRpred<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/LTRpred/man/LTRpred.meta.html">LTRpred.meta</a></span>(<span class="dt">genome.folder =</span> <span class="st">"store_genome_set"</span>,</a>
<a class="sourceLine" id="cb40-11" data-line-number="11">                      <span class="dt">output.folder =</span> <span class="st">"LTRpred_meta_results"</span>,</a>
<a class="sourceLine" id="cb40-12" data-line-number="12">                      <span class="dt">cores =</span> <span class="dv">3</span>)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#table-of-contents">Table of Contents</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#getting-started">Getting Started</a><ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#install-prerequisite-command-line-tools">Install prerequisite command line tools</a></li>
      <li><a href="#install-hmmer">Install <span>HMMER</span></a></li>
      <li><a href="#install-genometools">Install <span>GenomeTools</span></a></li>
      <li><a href="#install-usearch">Install <span>USEARCH</span></a></li>
      <li><a href="#install-vsearch">Install <span>VSEARCH</span></a></li>
      <li><a href="#blast"><span>BLAST</span></a></li>
      <li><a href="#quick-start">Quick Start</a></li>
      <li><a href="#detailed-ltrpred-run">Detailed LTRpred run</a></li>
      <li><a href="#metagenome-scale-annotations">Metagenome scale annotations</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hajk-Georg Drost.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
